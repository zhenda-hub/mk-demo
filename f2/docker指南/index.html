
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../django%E6%95%99%E7%A8%8B/">
      
      
        <link rel="next" href="../emoji-support/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Docker指南 - MkLorum</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#docker" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MkLorum" class="md-header__button md-logo" aria-label="MkLorum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MkLorum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Docker指南
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label=""  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label=""  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label=""  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label=""  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="" for="__palette_4" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="cyan"  aria-label=""  type="radio" name="__palette" id="__palette_4">
    
      <label class="md-header__button md-icon" title="" for="__palette_5" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="cyan"  aria-label=""  type="radio" name="__palette" id="__palette_5">
    
      <label class="md-header__button md-icon" title="" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MkLorum" class="md-nav__button md-logo" aria-label="MkLorum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MkLorum
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HOME
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ABOUT
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📋 Material for MkDocs 提示框完整指南
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Posts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/app-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/browser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Browser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/cloud-servers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud servers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/computer-science-crash-course/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computer science crash course
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            F1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f1/Decentralization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decentralization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f1/algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f1/crawler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crawler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f1/css-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Css guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f1/databases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Databases
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            F2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../django%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Django教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Docker指南
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Docker指南
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      docker介绍
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-docker" class="md-nav__link">
    <span class="md-ellipsis">
      why use docker?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      安装
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      相关教程
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      快速入门
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速入门">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker 基本概念
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker 基本概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repository" class="md-nav__link">
    <span class="md-ellipsis">
      Repository
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Repository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ghcr" class="md-nav__link">
    <span class="md-ellipsis">
      ghcr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      操作docker的方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      官方文档
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_1" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile 关键字
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workdir" class="md-nav__link">
    <span class="md-ellipsis">
      WORKDIR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      基础镜像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_2" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile示例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    <span class="md-ellipsis">
      多个port绑定的作用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-bind-mount" class="md-nav__link">
    <span class="md-ellipsis">
      Volume 和 Bind Mount
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Volume 和 Bind Mount">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    <span class="md-ellipsis">
      user 和 权限
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume" class="md-nav__link">
    <span class="md-ellipsis">
      Volume的数据迁移
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      进阶使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进阶使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-networking" class="md-nav__link">
    <span class="md-ellipsis">
      Container Networking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Networking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      网络解析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      官方文档
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml" class="md-nav__link">
    <span class="md-ellipsis">
      yaml文件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="yaml文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      书写规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yamljson" class="md-nav__link">
    <span class="md-ellipsis">
      yaml对比json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composeyaml" class="md-nav__link">
    <span class="md-ellipsis">
      compose.yaml的书写规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      环境变量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="环境变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      .env书写格式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      查看实际运行的配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composeyaml_1" class="md-nav__link">
    <span class="md-ellipsis">
      创建 compose.yaml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      常用命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    <span class="md-ellipsis">
      restart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#healthcheck" class="md-nav__link">
    <span class="md-ellipsis">
      healthcheck
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      deploy, replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    <span class="md-ellipsis">
      volumes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-contenxt" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Contenxt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      项目目录结构推荐
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cicd" class="md-nav__link">
    <span class="md-ellipsis">
      CI/CD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CI/CD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      主要构成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      工作流
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repo" class="md-nav__link">
    <span class="md-ellipsis">
      手动推送到repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_3" class="md-nav__link">
    <span class="md-ellipsis">
      docker 标签
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    <span class="md-ellipsis">
      为image设置时间辍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-actionscicd" class="md-nav__link">
    <span class="md-ellipsis">
      使用github actions来实现CI/CD的实际操作
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      其余内容
    </span>
  </a>
  
    <nav class="md-nav" aria-label="其余内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildx" class="md-nav__link">
    <span class="md-ellipsis">
      Buildx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-swarm" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Swarm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-desktop" class="md-nav__link">
    <span class="md-ellipsis">
      关于 Docker Desktop 的使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="关于 Docker Desktop 的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-wsl2" class="md-nav__link">
    <span class="md-ellipsis">
      使用 windows WSL2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      docker engine 配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-is-full" class="md-nav__link">
    <span class="md-ellipsis">
      报错 disk is full
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      更换安装位置到别的盘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      换源
    </span>
  </a>
  
    <nav class="md-nav" aria-label="换源">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    <span class="md-ellipsis">
      apt换国内源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pip" class="md-nav__link">
    <span class="md-ellipsis">
      pip换国内源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_4" class="md-nav__link">
    <span class="md-ellipsis">
      docker换国内源
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image_1" class="md-nav__link">
    <span class="md-ellipsis">
      Image测试平台
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../emoji-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emoji support
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            F3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/english-stu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    English stu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/evangelism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evangelism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/excel-note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Excel note
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/fastapi-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fastapi tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      docker介绍
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-docker" class="md-nav__link">
    <span class="md-ellipsis">
      why use docker?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      安装
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      相关教程
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      快速入门
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速入门">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#docker_1" class="md-nav__link">
    <span class="md-ellipsis">
      Docker 基本概念
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker 基本概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#repository" class="md-nav__link">
    <span class="md-ellipsis">
      Repository
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Repository">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ghcr" class="md-nav__link">
    <span class="md-ellipsis">
      ghcr
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_2" class="md-nav__link">
    <span class="md-ellipsis">
      操作docker的方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      官方文档
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_1" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile 关键字
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile 关键字">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#workdir" class="md-nav__link">
    <span class="md-ellipsis">
      WORKDIR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      基础镜像
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerfile_2" class="md-nav__link">
    <span class="md-ellipsis">
      Dockerfile示例
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dockerfile示例">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#port" class="md-nav__link">
    <span class="md-ellipsis">
      多个port绑定的作用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume-bind-mount" class="md-nav__link">
    <span class="md-ellipsis">
      Volume 和 Bind Mount
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Volume 和 Bind Mount">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user" class="md-nav__link">
    <span class="md-ellipsis">
      user 和 权限
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volume" class="md-nav__link">
    <span class="md-ellipsis">
      Volume的数据迁移
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      进阶使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进阶使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#container-networking" class="md-nav__link">
    <span class="md-ellipsis">
      Container Networking
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Container Networking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      网络解析
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-compose" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Compose
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker Compose">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      作用
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      官方文档
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml" class="md-nav__link">
    <span class="md-ellipsis">
      yaml文件
    </span>
  </a>
  
    <nav class="md-nav" aria-label="yaml文件">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      书写规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yamljson" class="md-nav__link">
    <span class="md-ellipsis">
      yaml对比json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composeyaml" class="md-nav__link">
    <span class="md-ellipsis">
      compose.yaml的书写规则
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      环境变量
    </span>
  </a>
  
    <nav class="md-nav" aria-label="环境变量">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#env" class="md-nav__link">
    <span class="md-ellipsis">
      .env书写格式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      查看实际运行的配置文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composeyaml_1" class="md-nav__link">
    <span class="md-ellipsis">
      创建 compose.yaml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      常用命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart" class="md-nav__link">
    <span class="md-ellipsis">
      restart
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#healthcheck" class="md-nav__link">
    <span class="md-ellipsis">
      healthcheck
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deploy-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      deploy, replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#volumes" class="md-nav__link">
    <span class="md-ellipsis">
      volumes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-contenxt" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Contenxt
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      项目目录结构推荐
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cicd" class="md-nav__link">
    <span class="md-ellipsis">
      CI/CD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CI/CD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      主要构成
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      工作流
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      原理
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      分类
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repo" class="md-nav__link">
    <span class="md-ellipsis">
      手动推送到repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_3" class="md-nav__link">
    <span class="md-ellipsis">
      docker 标签
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image" class="md-nav__link">
    <span class="md-ellipsis">
      为image设置时间辍
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#github-actionscicd" class="md-nav__link">
    <span class="md-ellipsis">
      使用github actions来实现CI/CD的实际操作
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      其余内容
    </span>
  </a>
  
    <nav class="md-nav" aria-label="其余内容">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#buildx" class="md-nav__link">
    <span class="md-ellipsis">
      Buildx
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-swarm" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Swarm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-desktop" class="md-nav__link">
    <span class="md-ellipsis">
      关于 Docker Desktop 的使用
    </span>
  </a>
  
    <nav class="md-nav" aria-label="关于 Docker Desktop 的使用">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-wsl2" class="md-nav__link">
    <span class="md-ellipsis">
      使用 windows WSL2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-engine" class="md-nav__link">
    <span class="md-ellipsis">
      docker engine 配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-is-full" class="md-nav__link">
    <span class="md-ellipsis">
      报错 disk is full
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      更换安装位置到别的盘
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      换源
    </span>
  </a>
  
    <nav class="md-nav" aria-label="换源">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#apt" class="md-nav__link">
    <span class="md-ellipsis">
      apt换国内源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pip" class="md-nav__link">
    <span class="md-ellipsis">
      pip换国内源
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker_4" class="md-nav__link">
    <span class="md-ellipsis">
      docker换国内源
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#image_1" class="md-nav__link">
    <span class="md-ellipsis">
      Image测试平台
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Docker指南</h1>

<p>+++
title = 'Docker指南'
subtitle = ""
date = 2024-01-09T00:04:35+08:00
draft = false
toc = true
tags = ["docker", "tools"]
+++</p>
<p>[toc]</p>
<h2 id="docker">docker介绍<a class="headerlink" href="#docker" title="Permanent link">&para;</a></h2>
<ul>
<li>Docker Desktop <a href="https://docs.docker.com/desktop/">https://docs.docker.com/desktop/</a></li>
<li>Docker Engine<ul>
<li>Docker Daemon（dockerd）<a href="https://docs.docker.com/engine/">https://docs.docker.com/engine/</a></li>
<li>REST API</li>
<li>Docker CLI</li>
</ul>
</li>
<li>scout</li>
<li>Compose</li>
<li>k8s</li>
</ul>
<h2 id="why-use-docker">why use docker?<a class="headerlink" href="#why-use-docker" title="Permanent link">&para;</a></h2>
<ul>
<li>环境一致性, 让开发和部署保持一致, DevOps 真正落地</li>
<li>适合构建微服务架构</li>
</ul>
<h2 id="_1">安装<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>docker engine 推荐安装
docker desktop 可以不安装</p>
<p>把自己加入 docker 组
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a>getent<span class="w"> </span>group<span class="w"> </span>docker
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
</span></code></pre></div></p>
<h2 id="_2">相关教程<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docker-practice.github.io/zh-cn/introduction/">https://docker-practice.github.io/zh-cn/introduction/</a></li>
<li><a href="https://juejin.cn/post/7154437479955693598">https://juejin.cn/post/7154437479955693598</a></li>
</ul>
<h2 id="_3">快速入门<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p><strong>概念 -&gt; 操作方法 -&gt; 使用Container</strong></p>
<h3 id="docker_1">Docker 基本概念<a class="headerlink" href="#docker_1" title="Permanent link">&para;</a></h3>
<p>Container是实际使用的实例, 主要通过以下两种方法生成:</p>
<p><strong>Repository -&gt; Image -&gt; Container</strong>
<strong>Dockerfile -&gt; Image -&gt; Container</strong></p>
<p>Volume: 存储数据
Network: 容器网络通信
宿主机: 本人使用的电脑</p>
<table>
<thead>
<tr>
<th>概念</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Image</strong></td>
<td>一个只读的模板，包含了运行容器所需的全部内容，包括代码、运行时、系统工具、系统库等等。可以把它看作是一个root文件系统。</td>
</tr>
<tr>
<td><strong>Container</strong></td>
<td>镜像的一个运行实例，可以启动、停止、删除。容器是完全使用沙箱机制，相互之间不会有任何接口。</td>
</tr>
<tr>
<td><strong>Repository</strong></td>
<td>用来保存镜像的一个目录。可以将其理解为一个仓库，里面存放着许多个镜像。</td>
</tr>
<tr>
<td><strong>Dockerfile</strong></td>
<td>一个文本文件，里面包含了一条条指令，告诉Docker如何一步一步地构建一个镜像。</td>
</tr>
<tr>
<td><strong>Volume</strong></td>
<td>持久化数据的一种方式，可以将容器中的数据保存到宿主机上。</td>
</tr>
<tr>
<td><strong>Bind Mount</strong></td>
<td>主机文件系统中指定路径与容器中路径的挂载，适用于共享或持久化特定文件或目录。</td>
</tr>
<tr>
<td><strong>Network</strong></td>
<td>Docker提供了多种网络模式，用于容器之间的通信和与宿主机之间的通信。</td>
</tr>
<tr>
<td><strong>Compose</strong></td>
<td>Docker Compose，定义和管理多容器应用的工具，使用 <code>docker-compose.yaml</code> 文件描述服务。</td>
</tr>
<tr>
<td>Swarm</td>
<td>Docker Swarm，是 Docker 的原生集群管理和编排工具，用于管理多个 Docker 主机。</td>
</tr>
<tr>
<td>Kubernetes</td>
<td>用于容器编排和管理的开源平台，支持自动化部署、扩展和管理应用程序。</td>
</tr>
<tr>
<td>Service</td>
<td>在 Swarm 模式下，定义了如何部署和管理一组容器实例。</td>
</tr>
<tr>
<td>Stack</td>
<td>在 Docker Swarm 或 Compose 中定义的一组相关服务和资源。</td>
</tr>
<tr>
<td>Dangling 镜像</td>
<td>是指没有标签（tag）且不被任何容器使用的镜像</td>
</tr>
<tr>
<td>Dangling 卷</td>
<td>是指没有标签（tag）且不被任何容器使用的卷</td>
</tr>
</tbody>
</table>
<h4 id="repository">Repository<a class="headerlink" href="#repository" title="Permanent link">&para;</a></h4>
<ul>
<li>dockerhub</li>
<li>自动build 需要付费</li>
<li>ghcr</li>
</ul>
<h5 id="ghcr">ghcr<a class="headerlink" href="#ghcr" title="Permanent link">&para;</a></h5>
<p>相关教程:
- <a href="https://docs.github.com/zh/packages/working-with-a-github-packages-registry/working-with-the-container-registry">https://docs.github.com/zh/packages/working-with-a-github-packages-registry/working-with-the-container-registry</a>
- <a href="https://medium.com/@deepak1812002/get-started-with-github-ghcr-an-alternative-of-dockerhub-f7d5b2198b9a">https://medium.com/@deepak1812002/get-started-with-github-ghcr-an-alternative-of-dockerhub-f7d5b2198b9a</a>
- <a href="https://gist.github.com/yokawasa/841b6db379aa68b2859846da84a9643c">https://gist.github.com/yokawasa/841b6db379aa68b2859846da84a9643c</a></p>
<p>token设置地址:
- <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a></p>
<h3 id="docker_2">操作docker的方法<a class="headerlink" href="#docker_2" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>可视化工具</p>
</li>
<li>
<p>portainer (第三方web工具, 推荐)</p>
</li>
<li>
<p>docker desktop</p>
</li>
<li>
<p>docker cli命令</p>
</li>
<li>
<p>查阅命令</p>
</li>
</ol>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a>docker<span class="w"> </span>--help
</span></code></pre></div>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos=" 1 "></span></a>Usage:<span class="w">  </span>docker<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos=" 3 "></span></a>A<span class="w"> </span>self-sufficient<span class="w"> </span>runtime<span class="w"> </span><span class="k">for</span><span class="w"> </span>containers
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos=" 5 "></span></a>Common<span class="w"> </span>Commands:
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">  </span>run<span class="w">         </span>Create<span class="w"> </span>and<span class="w"> </span>run<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>container<span class="w"> </span>from<span class="w"> </span>an<span class="w"> </span>image
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="nb">exec</span><span class="w">        </span>Execute<span class="w"> </span>a<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>running<span class="w"> </span>container
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span>ps<span class="w">          </span>List<span class="w"> </span>containers
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><a href="#__codelineno-2-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span>build<span class="w">       </span>Build<span class="w"> </span>an<span class="w"> </span>image<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>Dockerfile
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><a href="#__codelineno-2-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span>pull<span class="w">        </span>Download<span class="w"> </span>an<span class="w"> </span>image<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>registry
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><a href="#__codelineno-2-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span>push<span class="w">        </span>Upload<span class="w"> </span>an<span class="w"> </span>image<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>registry
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><a href="#__codelineno-2-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">  </span>images<span class="w">      </span>List<span class="w"> </span>images
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><a href="#__codelineno-2-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span>login<span class="w">       </span>Log<span class="w"> </span><span class="k">in</span><span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>registry
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><a href="#__codelineno-2-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="nb">logout</span><span class="w">      </span>Log<span class="w"> </span>out<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>registry
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><a href="#__codelineno-2-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">  </span>search<span class="w">      </span>Search<span class="w"> </span>Docker<span class="w"> </span>Hub<span class="w"> </span><span class="k">for</span><span class="w"> </span>images
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><a href="#__codelineno-2-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span>version<span class="w">     </span>Show<span class="w"> </span>the<span class="w"> </span>Docker<span class="w"> </span>version<span class="w"> </span>information
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><a href="#__codelineno-2-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span>info<span class="w">        </span>Display<span class="w"> </span>system-wide<span class="w"> </span>information
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a><a href="#__codelineno-2-18"><span class="linenos" data-linenos="18 "></span></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a><a href="#__codelineno-2-19"><span class="linenos" data-linenos="19 "></span></a>Management<span class="w"> </span>Commands:
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a><a href="#__codelineno-2-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">  </span>builder<span class="w">     </span>Manage<span class="w"> </span>builds
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a><a href="#__codelineno-2-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">  </span>buildx*<span class="w">     </span>Docker<span class="w"> </span>Buildx
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a><a href="#__codelineno-2-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">  </span>compose*<span class="w">    </span>Docker<span class="w"> </span>Compose
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a><a href="#__codelineno-2-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">  </span>container<span class="w">   </span>Manage<span class="w"> </span>containers
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a><a href="#__codelineno-2-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">  </span>context<span class="w">     </span>Manage<span class="w"> </span>contexts
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a><a href="#__codelineno-2-25"><span class="linenos" data-linenos="25 "></span></a><span class="w">  </span>debug*<span class="w">      </span>Get<span class="w"> </span>a<span class="w"> </span>shell<span class="w"> </span>into<span class="w"> </span>any<span class="w"> </span>image<span class="w"> </span>or<span class="w"> </span>container
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a><a href="#__codelineno-2-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">  </span>desktop*<span class="w">    </span>Docker<span class="w"> </span>Desktop<span class="w"> </span>commands<span class="w"> </span><span class="o">(</span>Alpha<span class="o">)</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a><a href="#__codelineno-2-27"><span class="linenos" data-linenos="27 "></span></a><span class="w">  </span>dev*<span class="w">        </span>Docker<span class="w"> </span>Dev<span class="w"> </span>Environments
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a><a href="#__codelineno-2-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">  </span>extension*<span class="w">  </span>Manages<span class="w"> </span>Docker<span class="w"> </span>extensions
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a><a href="#__codelineno-2-29"><span class="linenos" data-linenos="29 "></span></a><span class="w">  </span>feedback*<span class="w">   </span>Provide<span class="w"> </span>feedback,<span class="w"> </span>right<span class="w"> </span><span class="k">in</span><span class="w"> </span>your<span class="w"> </span>terminal!
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a><a href="#__codelineno-2-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">  </span>image<span class="w">       </span>Manage<span class="w"> </span>images
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a><a href="#__codelineno-2-31"><span class="linenos" data-linenos="31 "></span></a><span class="w">  </span>init*<span class="w">       </span>Creates<span class="w"> </span>Docker-related<span class="w"> </span>starter<span class="w"> </span>files<span class="w"> </span><span class="k">for</span><span class="w"> </span>your<span class="w"> </span>project
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32"></a><a href="#__codelineno-2-32"><span class="linenos" data-linenos="32 "></span></a><span class="w">  </span>manifest<span class="w">    </span>Manage<span class="w"> </span>Docker<span class="w"> </span>image<span class="w"> </span>manifests<span class="w"> </span>and<span class="w"> </span>manifest<span class="w"> </span>lists
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33"></a><a href="#__codelineno-2-33"><span class="linenos" data-linenos="33 "></span></a><span class="w">  </span>network<span class="w">     </span>Manage<span class="w"> </span>networks
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34"></a><a href="#__codelineno-2-34"><span class="linenos" data-linenos="34 "></span></a><span class="w">  </span>plugin<span class="w">      </span>Manage<span class="w"> </span>plugins
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35"></a><a href="#__codelineno-2-35"><span class="linenos" data-linenos="35 "></span></a><span class="w">  </span>sbom*<span class="w">       </span>View<span class="w"> </span>the<span class="w"> </span>packaged-based<span class="w"> </span>Software<span class="w"> </span>Bill<span class="w"> </span>Of<span class="w"> </span>Materials<span class="w"> </span><span class="o">(</span>SBOM<span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>an<span class="w"> </span>image
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36"></a><a href="#__codelineno-2-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">  </span>scout*<span class="w">      </span>Docker<span class="w"> </span>Scout
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37"></a><a href="#__codelineno-2-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">  </span>system<span class="w">      </span>Manage<span class="w"> </span>Docker
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38"></a><a href="#__codelineno-2-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">  </span>trust<span class="w">       </span>Manage<span class="w"> </span>trust<span class="w"> </span>on<span class="w"> </span>Docker<span class="w"> </span>images
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39"></a><a href="#__codelineno-2-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">  </span>volume<span class="w">      </span>Manage<span class="w"> </span>volumes
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40"></a><a href="#__codelineno-2-40"><span class="linenos" data-linenos="40 "></span></a>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41"></a><a href="#__codelineno-2-41"><span class="linenos" data-linenos="41 "></span></a>Swarm<span class="w"> </span>Commands:
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42"></a><a href="#__codelineno-2-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">  </span>swarm<span class="w">       </span>Manage<span class="w"> </span>Swarm
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43"></a><a href="#__codelineno-2-43"><span class="linenos" data-linenos="43 "></span></a>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44"></a><a href="#__codelineno-2-44"><span class="linenos" data-linenos="44 "></span></a>Commands:
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45"></a><a href="#__codelineno-2-45"><span class="linenos" data-linenos="45 "></span></a><span class="w">  </span>attach<span class="w">      </span>Attach<span class="w"> </span><span class="nb">local</span><span class="w"> </span>standard<span class="w"> </span>input,<span class="w"> </span>output,<span class="w"> </span>and<span class="w"> </span>error<span class="w"> </span>streams<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>running<span class="w"> </span>container
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46"></a><a href="#__codelineno-2-46"><span class="linenos" data-linenos="46 "></span></a><span class="w">  </span>commit<span class="w">      </span>Create<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>image<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>container<span class="s1">&#39;s changes</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47"></a><a href="#__codelineno-2-47"><span class="linenos" data-linenos="47 "></span></a><span class="s1">  cp          Copy files/folders between a container and the local filesystem</span>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48"></a><a href="#__codelineno-2-48"><span class="linenos" data-linenos="48 "></span></a><span class="s1">  create      Create a new container</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49"></a><a href="#__codelineno-2-49"><span class="linenos" data-linenos="49 "></span></a><span class="s1">  diff        Inspect changes to files or directories on a container&#39;</span>s<span class="w"> </span>filesystem
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50"></a><a href="#__codelineno-2-50"><span class="linenos" data-linenos="50 "></span></a><span class="w">  </span>events<span class="w">      </span>Get<span class="w"> </span>real<span class="w"> </span><span class="nb">time</span><span class="w"> </span>events<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>server
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51"></a><a href="#__codelineno-2-51"><span class="linenos" data-linenos="51 "></span></a><span class="w">  </span><span class="nb">export</span><span class="w">      </span>Export<span class="w"> </span>a<span class="w"> </span>container<span class="s1">&#39;s filesystem as a tar archive</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52"></a><a href="#__codelineno-2-52"><span class="linenos" data-linenos="52 "></span></a><span class="s1">  history     Show the history of an image</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53"></a><a href="#__codelineno-2-53"><span class="linenos" data-linenos="53 "></span></a><span class="s1">  import      Import the contents from a tarball to create a filesystem image</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54"></a><a href="#__codelineno-2-54"><span class="linenos" data-linenos="54 "></span></a><span class="s1">  inspect     Return low-level information on Docker objects</span>
</span><span id="__span-2-55"><a id="__codelineno-2-55" name="__codelineno-2-55"></a><a href="#__codelineno-2-55"><span class="linenos" data-linenos="55 "></span></a><span class="s1">  kill        Kill one or more running containers</span>
</span><span id="__span-2-56"><a id="__codelineno-2-56" name="__codelineno-2-56"></a><a href="#__codelineno-2-56"><span class="linenos" data-linenos="56 "></span></a><span class="s1">  load        Load an image from a tar archive or STDIN</span>
</span><span id="__span-2-57"><a id="__codelineno-2-57" name="__codelineno-2-57"></a><a href="#__codelineno-2-57"><span class="linenos" data-linenos="57 "></span></a><span class="s1">  logs        Fetch the logs of a container</span>
</span><span id="__span-2-58"><a id="__codelineno-2-58" name="__codelineno-2-58"></a><a href="#__codelineno-2-58"><span class="linenos" data-linenos="58 "></span></a><span class="s1">  pause       Pause all processes within one or more containers</span>
</span><span id="__span-2-59"><a id="__codelineno-2-59" name="__codelineno-2-59"></a><a href="#__codelineno-2-59"><span class="linenos" data-linenos="59 "></span></a><span class="s1">  port        List port mappings or a specific mapping for the container</span>
</span><span id="__span-2-60"><a id="__codelineno-2-60" name="__codelineno-2-60"></a><a href="#__codelineno-2-60"><span class="linenos" data-linenos="60 "></span></a><span class="s1">  rename      Rename a container</span>
</span><span id="__span-2-61"><a id="__codelineno-2-61" name="__codelineno-2-61"></a><a href="#__codelineno-2-61"><span class="linenos" data-linenos="61 "></span></a><span class="s1">  restart     Restart one or more containers</span>
</span><span id="__span-2-62"><a id="__codelineno-2-62" name="__codelineno-2-62"></a><a href="#__codelineno-2-62"><span class="linenos" data-linenos="62 "></span></a><span class="s1">  rm          Remove one or more containers</span>
</span><span id="__span-2-63"><a id="__codelineno-2-63" name="__codelineno-2-63"></a><a href="#__codelineno-2-63"><span class="linenos" data-linenos="63 "></span></a><span class="s1">  rmi         Remove one or more images</span>
</span><span id="__span-2-64"><a id="__codelineno-2-64" name="__codelineno-2-64"></a><a href="#__codelineno-2-64"><span class="linenos" data-linenos="64 "></span></a><span class="s1">  save        Save one or more images to a tar archive (streamed to STDOUT by default)</span>
</span><span id="__span-2-65"><a id="__codelineno-2-65" name="__codelineno-2-65"></a><a href="#__codelineno-2-65"><span class="linenos" data-linenos="65 "></span></a><span class="s1">  start       Start one or more stopped containers</span>
</span><span id="__span-2-66"><a id="__codelineno-2-66" name="__codelineno-2-66"></a><a href="#__codelineno-2-66"><span class="linenos" data-linenos="66 "></span></a><span class="s1">  stats       Display a live stream of container(s) resource usage statistics</span>
</span><span id="__span-2-67"><a id="__codelineno-2-67" name="__codelineno-2-67"></a><a href="#__codelineno-2-67"><span class="linenos" data-linenos="67 "></span></a><span class="s1">  stop        Stop one or more running containers</span>
</span><span id="__span-2-68"><a id="__codelineno-2-68" name="__codelineno-2-68"></a><a href="#__codelineno-2-68"><span class="linenos" data-linenos="68 "></span></a><span class="s1">  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE</span>
</span><span id="__span-2-69"><a id="__codelineno-2-69" name="__codelineno-2-69"></a><a href="#__codelineno-2-69"><span class="linenos" data-linenos="69 "></span></a><span class="s1">  top         Display the running processes of a container</span>
</span><span id="__span-2-70"><a id="__codelineno-2-70" name="__codelineno-2-70"></a><a href="#__codelineno-2-70"><span class="linenos" data-linenos="70 "></span></a><span class="s1">  unpause     Unpause all processes within one or more containers</span>
</span><span id="__span-2-71"><a id="__codelineno-2-71" name="__codelineno-2-71"></a><a href="#__codelineno-2-71"><span class="linenos" data-linenos="71 "></span></a><span class="s1">  update      Update configuration of one or more containers</span>
</span><span id="__span-2-72"><a id="__codelineno-2-72" name="__codelineno-2-72"></a><a href="#__codelineno-2-72"><span class="linenos" data-linenos="72 "></span></a><span class="s1">  wait        Block until one or more containers stop, then print their exit codes</span>
</span><span id="__span-2-73"><a id="__codelineno-2-73" name="__codelineno-2-73"></a><a href="#__codelineno-2-73"><span class="linenos" data-linenos="73 "></span></a>
</span><span id="__span-2-74"><a id="__codelineno-2-74" name="__codelineno-2-74"></a><a href="#__codelineno-2-74"><span class="linenos" data-linenos="74 "></span></a><span class="s1">Global Options:</span>
</span><span id="__span-2-75"><a id="__codelineno-2-75" name="__codelineno-2-75"></a><a href="#__codelineno-2-75"><span class="linenos" data-linenos="75 "></span></a><span class="s1">      --config string      Location of client config files (default &quot;/home/zhenda/.docker&quot;)</span>
</span><span id="__span-2-76"><a id="__codelineno-2-76" name="__codelineno-2-76"></a><a href="#__codelineno-2-76"><span class="linenos" data-linenos="76 "></span></a><span class="s1">  -c, --context string     Name of the context to use to connect to the daemon (overrides DOCKER_HOST env var and default context set with &quot;docker context use&quot;)</span>
</span><span id="__span-2-77"><a id="__codelineno-2-77" name="__codelineno-2-77"></a><a href="#__codelineno-2-77"><span class="linenos" data-linenos="77 "></span></a><span class="s1">  -D, --debug              Enable debug mode</span>
</span><span id="__span-2-78"><a id="__codelineno-2-78" name="__codelineno-2-78"></a><a href="#__codelineno-2-78"><span class="linenos" data-linenos="78 "></span></a><span class="s1">  -H, --host list          Daemon socket to connect to</span>
</span><span id="__span-2-79"><a id="__codelineno-2-79" name="__codelineno-2-79"></a><a href="#__codelineno-2-79"><span class="linenos" data-linenos="79 "></span></a><span class="s1">  -l, --log-level string   Set the logging level (&quot;debug&quot;, &quot;info&quot;, &quot;warn&quot;, &quot;error&quot;, &quot;fatal&quot;) (default &quot;info&quot;)</span>
</span><span id="__span-2-80"><a id="__codelineno-2-80" name="__codelineno-2-80"></a><a href="#__codelineno-2-80"><span class="linenos" data-linenos="80 "></span></a><span class="s1">      --tls                Use TLS; implied by --tlsverify</span>
</span><span id="__span-2-81"><a id="__codelineno-2-81" name="__codelineno-2-81"></a><a href="#__codelineno-2-81"><span class="linenos" data-linenos="81 "></span></a><span class="s1">      --tlscacert string   Trust certs signed only by this CA (default &quot;/home/zhenda/.docker/ca.pem&quot;)</span>
</span><span id="__span-2-82"><a id="__codelineno-2-82" name="__codelineno-2-82"></a><a href="#__codelineno-2-82"><span class="linenos" data-linenos="82 "></span></a><span class="s1">      --tlscert string     Path to TLS certificate file (default &quot;/home/zhenda/.docker/cert.pem&quot;)</span>
</span><span id="__span-2-83"><a id="__codelineno-2-83" name="__codelineno-2-83"></a><a href="#__codelineno-2-83"><span class="linenos" data-linenos="83 "></span></a><span class="s1">      --tlskey string      Path to TLS key file (default &quot;/home/zhenda/.docker/key.pem&quot;)</span>
</span><span id="__span-2-84"><a id="__codelineno-2-84" name="__codelineno-2-84"></a><a href="#__codelineno-2-84"><span class="linenos" data-linenos="84 "></span></a><span class="s1">      --tlsverify          Use TLS and verify the remote</span>
</span><span id="__span-2-85"><a id="__codelineno-2-85" name="__codelineno-2-85"></a><a href="#__codelineno-2-85"><span class="linenos" data-linenos="85 "></span></a><span class="s1">  -v, --version            Print version information and quit</span>
</span><span id="__span-2-86"><a id="__codelineno-2-86" name="__codelineno-2-86"></a><a href="#__codelineno-2-86"><span class="linenos" data-linenos="86 "></span></a>
</span><span id="__span-2-87"><a id="__codelineno-2-87" name="__codelineno-2-87"></a><a href="#__codelineno-2-87"><span class="linenos" data-linenos="87 "></span></a><span class="s1">Run &#39;</span>docker<span class="w"> </span>COMMAND<span class="w"> </span>--help<span class="err">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>command.
</span><span id="__span-2-88"><a id="__codelineno-2-88" name="__codelineno-2-88"></a><a href="#__codelineno-2-88"><span class="linenos" data-linenos="88 "></span></a>
</span><span id="__span-2-89"><a id="__codelineno-2-89" name="__codelineno-2-89"></a><a href="#__codelineno-2-89"><span class="linenos" data-linenos="89 "></span></a>For<span class="w"> </span>more<span class="w"> </span><span class="nb">help</span><span class="w"> </span>on<span class="w"> </span>how<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>Docker,<span class="w"> </span>head<span class="w"> </span>to<span class="w"> </span>https://docs.docker.com/go/guides/
</span></code></pre></div>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos="1 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>--help
</span></code></pre></div>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><a href="#__codelineno-4-1"><span class="linenos" data-linenos=" 1 "></span></a>Usage:<span class="w">  </span>docker<span class="w"> </span>compose<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a><a href="#__codelineno-4-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a><a href="#__codelineno-4-3"><span class="linenos" data-linenos=" 3 "></span></a>Define<span class="w"> </span>and<span class="w"> </span>run<span class="w"> </span>multi-container<span class="w"> </span>applications<span class="w"> </span>with<span class="w"> </span>Docker
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><a href="#__codelineno-4-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a><a href="#__codelineno-4-5"><span class="linenos" data-linenos=" 5 "></span></a>Options:
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a><a href="#__codelineno-4-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">      </span>--all-resources<span class="w">              </span>Include<span class="w"> </span>all<span class="w"> </span>resources,<span class="w"> </span>even<span class="w"> </span>those<span class="w"> </span>not<span class="w"> </span>used<span class="w"> </span>by<span class="w"> </span>services
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><a href="#__codelineno-4-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">      </span>--ansi<span class="w"> </span>string<span class="w">                </span>Control<span class="w"> </span>when<span class="w"> </span>to<span class="w"> </span>print<span class="w"> </span>ANSI<span class="w"> </span>control<span class="w"> </span>characters<span class="w"> </span><span class="o">(</span><span class="s2">&quot;never&quot;</span><span class="p">|</span><span class="s2">&quot;always&quot;</span><span class="p">|</span><span class="s2">&quot;auto&quot;</span><span class="o">)</span><span class="w"> </span><span class="o">(</span>default<span class="w"> </span><span class="s2">&quot;auto&quot;</span><span class="o">)</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a><a href="#__codelineno-4-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">      </span>--compatibility<span class="w">              </span>Run<span class="w"> </span>compose<span class="w"> </span><span class="k">in</span><span class="w"> </span>backward<span class="w"> </span>compatibility<span class="w"> </span>mode
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a><a href="#__codelineno-4-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">      </span>--dry-run<span class="w">                    </span>Execute<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="k">in</span><span class="w"> </span>dry<span class="w"> </span>run<span class="w"> </span>mode
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a><a href="#__codelineno-4-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">      </span>--env-file<span class="w"> </span>stringArray<span class="w">       </span>Specify<span class="w"> </span>an<span class="w"> </span>alternate<span class="w"> </span>environment<span class="w"> </span>file
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a><a href="#__codelineno-4-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">  </span>-f,<span class="w"> </span>--file<span class="w"> </span>stringArray<span class="w">           </span>Compose<span class="w"> </span>configuration<span class="w"> </span>files
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a><a href="#__codelineno-4-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">      </span>--parallel<span class="w"> </span>int<span class="w">               </span>Control<span class="w"> </span>max<span class="w"> </span>parallelism,<span class="w"> </span>-1<span class="w"> </span><span class="k">for</span><span class="w"> </span>unlimited<span class="w"> </span><span class="o">(</span>default<span class="w"> </span>-1<span class="o">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a><a href="#__codelineno-4-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">      </span>--profile<span class="w"> </span>stringArray<span class="w">        </span>Specify<span class="w"> </span>a<span class="w"> </span>profile<span class="w"> </span>to<span class="w"> </span><span class="nb">enable</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a><a href="#__codelineno-4-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">      </span>--progress<span class="w"> </span>string<span class="w">            </span>Set<span class="w"> </span><span class="nb">type</span><span class="w"> </span>of<span class="w"> </span>progress<span class="w"> </span>output<span class="w"> </span><span class="o">(</span>auto,<span class="w"> </span>tty,<span class="w"> </span>plain,<span class="w"> </span>quiet<span class="o">)</span><span class="w"> </span><span class="o">(</span>default<span class="w"> </span><span class="s2">&quot;auto&quot;</span><span class="o">)</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a><a href="#__codelineno-4-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">      </span>--project-directory<span class="w"> </span>string<span class="w">   </span>Specify<span class="w"> </span>an<span class="w"> </span>alternate<span class="w"> </span>working<span class="w"> </span>directory
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a><a href="#__codelineno-4-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">                                   </span><span class="o">(</span>default:<span class="w"> </span>the<span class="w"> </span>path<span class="w"> </span>of<span class="w"> </span>the,<span class="w"> </span>first<span class="w"> </span>specified,<span class="w"> </span>Compose<span class="w"> </span>file<span class="o">)</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a><a href="#__codelineno-4-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">  </span>-p,<span class="w"> </span>--project-name<span class="w"> </span>string<span class="w">        </span>Project<span class="w"> </span>name
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a><a href="#__codelineno-4-18"><span class="linenos" data-linenos="18 "></span></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a><a href="#__codelineno-4-19"><span class="linenos" data-linenos="19 "></span></a>Commands:
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a><a href="#__codelineno-4-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">  </span>attach<span class="w">      </span>Attach<span class="w"> </span><span class="nb">local</span><span class="w"> </span>standard<span class="w"> </span>input,<span class="w"> </span>output,<span class="w"> </span>and<span class="w"> </span>error<span class="w"> </span>streams<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>service<span class="s1">&#39;s running container</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a><a href="#__codelineno-4-21"><span class="linenos" data-linenos="21 "></span></a><span class="s1">  build       Build or rebuild services</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a><a href="#__codelineno-4-22"><span class="linenos" data-linenos="22 "></span></a><span class="s1">  config      Parse, resolve and render compose file in canonical format</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a><a href="#__codelineno-4-23"><span class="linenos" data-linenos="23 "></span></a><span class="s1">  cp          Copy files/folders between a service container and the local filesystem</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a><a href="#__codelineno-4-24"><span class="linenos" data-linenos="24 "></span></a><span class="s1">  create      Creates containers for a service</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a><a href="#__codelineno-4-25"><span class="linenos" data-linenos="25 "></span></a><span class="s1">  down        Stop and remove containers, networks</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a><a href="#__codelineno-4-26"><span class="linenos" data-linenos="26 "></span></a><span class="s1">  events      Receive real time events from containers</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a><a href="#__codelineno-4-27"><span class="linenos" data-linenos="27 "></span></a><span class="s1">  exec        Execute a command in a running container</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a><a href="#__codelineno-4-28"><span class="linenos" data-linenos="28 "></span></a><span class="s1">  images      List images used by the created containers</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a><a href="#__codelineno-4-29"><span class="linenos" data-linenos="29 "></span></a><span class="s1">  kill        Force stop service containers</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30"></a><a href="#__codelineno-4-30"><span class="linenos" data-linenos="30 "></span></a><span class="s1">  logs        View output from containers</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31"></a><a href="#__codelineno-4-31"><span class="linenos" data-linenos="31 "></span></a><span class="s1">  ls          List running compose projects</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32"></a><a href="#__codelineno-4-32"><span class="linenos" data-linenos="32 "></span></a><span class="s1">  pause       Pause services</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33"></a><a href="#__codelineno-4-33"><span class="linenos" data-linenos="33 "></span></a><span class="s1">  port        Print the public port for a port binding</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34"></a><a href="#__codelineno-4-34"><span class="linenos" data-linenos="34 "></span></a><span class="s1">  ps          List containers</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35"></a><a href="#__codelineno-4-35"><span class="linenos" data-linenos="35 "></span></a><span class="s1">  pull        Pull service images</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36"></a><a href="#__codelineno-4-36"><span class="linenos" data-linenos="36 "></span></a><span class="s1">  push        Push service images</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37"></a><a href="#__codelineno-4-37"><span class="linenos" data-linenos="37 "></span></a><span class="s1">  restart     Restart service containers</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38"></a><a href="#__codelineno-4-38"><span class="linenos" data-linenos="38 "></span></a><span class="s1">  rm          Removes stopped service containers</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39"></a><a href="#__codelineno-4-39"><span class="linenos" data-linenos="39 "></span></a><span class="s1">  run         Run a one-off command on a service</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40"></a><a href="#__codelineno-4-40"><span class="linenos" data-linenos="40 "></span></a><span class="s1">  scale       Scale services </span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41"></a><a href="#__codelineno-4-41"><span class="linenos" data-linenos="41 "></span></a><span class="s1">  start       Start services</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42"></a><a href="#__codelineno-4-42"><span class="linenos" data-linenos="42 "></span></a><span class="s1">  stats       Display a live stream of container(s) resource usage statistics</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43"></a><a href="#__codelineno-4-43"><span class="linenos" data-linenos="43 "></span></a><span class="s1">  stop        Stop services</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44"></a><a href="#__codelineno-4-44"><span class="linenos" data-linenos="44 "></span></a><span class="s1">  top         Display the running processes</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45"></a><a href="#__codelineno-4-45"><span class="linenos" data-linenos="45 "></span></a><span class="s1">  unpause     Unpause services</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46"></a><a href="#__codelineno-4-46"><span class="linenos" data-linenos="46 "></span></a><span class="s1">  up          Create and start containers</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47"></a><a href="#__codelineno-4-47"><span class="linenos" data-linenos="47 "></span></a><span class="s1">  version     Show the Docker Compose version information</span>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48"></a><a href="#__codelineno-4-48"><span class="linenos" data-linenos="48 "></span></a><span class="s1">  wait        Block until the first service container stops</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49"></a><a href="#__codelineno-4-49"><span class="linenos" data-linenos="49 "></span></a><span class="s1">  watch       Watch build context for service and rebuild/refresh containers when files are updated</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50"></a><a href="#__codelineno-4-50"><span class="linenos" data-linenos="50 "></span></a>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51"></a><a href="#__codelineno-4-51"><span class="linenos" data-linenos="51 "></span></a><span class="s1">Run &#39;</span>docker<span class="w"> </span>compose<span class="w"> </span>COMMAND<span class="w"> </span>--help<span class="err">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>command.
</span></code></pre></div>
<ul>
<li>常用命令</li>
</ul>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><a href="#__codelineno-5-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># 创建 context</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><a href="#__codelineno-5-2"><span class="linenos" data-linenos=" 2 "></span></a>docker<span class="w"> </span>context<span class="w"> </span>create<span class="w"> </span>desktop-linux<span class="w"> </span>--description<span class="w"> </span><span class="s2">&quot;Docker Desktop&quot;</span><span class="w"> </span>--docker<span class="w"> </span><span class="s2">&quot;host=unix:///home/YOUR_USER_NAME/.docker/desktop/docker.sock&quot;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a><a href="#__codelineno-5-3"><span class="linenos" data-linenos=" 3 "></span></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><a href="#__codelineno-5-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1"># create files</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a><a href="#__codelineno-5-5"><span class="linenos" data-linenos=" 5 "></span></a>docker<span class="w"> </span>init
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a><a href="#__codelineno-5-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><a href="#__codelineno-5-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># repo</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><a href="#__codelineno-5-8"><span class="linenos" data-linenos=" 8 "></span></a>docker<span class="w"> </span>pull<span class="w"> </span>username/image_name:tag_version
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><a href="#__codelineno-5-9"><span class="linenos" data-linenos=" 9 "></span></a>docker<span class="w"> </span>push<span class="w"> </span>username/image_name:tag_version
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><a href="#__codelineno-5-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><a href="#__codelineno-5-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># image</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><a href="#__codelineno-5-12"><span class="linenos" data-linenos="12 "></span></a>docker<span class="w"> </span>images
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><a href="#__codelineno-5-13"><span class="linenos" data-linenos="13 "></span></a>docker<span class="w"> </span>built<span class="w"> </span>-t<span class="w"> </span>username/image_name:tag_version<span class="w"> </span>.
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a><a href="#__codelineno-5-14"><span class="linenos" data-linenos="14 "></span></a>docker<span class="w"> </span>tag<span class="w"> </span>old_image_name<span class="w"> </span>new_image_name
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a><a href="#__codelineno-5-15"><span class="linenos" data-linenos="15 "></span></a>docker<span class="w"> </span>rmi<span class="w"> </span>image_id
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16"></a><a href="#__codelineno-5-16"><span class="linenos" data-linenos="16 "></span></a><span class="c1"># 删除 dangling image</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17"></a><a href="#__codelineno-5-17"><span class="linenos" data-linenos="17 "></span></a>docker<span class="w"> </span>image<span class="w"> </span>prune
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18"></a><a href="#__codelineno-5-18"><span class="linenos" data-linenos="18 "></span></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19"></a><a href="#__codelineno-5-19"><span class="linenos" data-linenos="19 "></span></a><span class="c1"># container</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20"></a><a href="#__codelineno-5-20"><span class="linenos" data-linenos="20 "></span></a>docker<span class="w"> </span>ps
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21"></a><a href="#__codelineno-5-21"><span class="linenos" data-linenos="21 "></span></a>docker<span class="w"> </span>ps<span class="w"> </span>-a
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22"></a><a href="#__codelineno-5-22"><span class="linenos" data-linenos="22 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span>local_ip:container_ip<span class="w"> </span>username/image_name:tag_version
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23"></a><a href="#__codelineno-5-23"><span class="linenos" data-linenos="23 "></span></a><span class="c1"># exec, exit退出此模式</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24"></a><a href="#__codelineno-5-24"><span class="linenos" data-linenos="24 "></span></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>container_id<span class="w"> </span>/bin/bash
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25"></a><a href="#__codelineno-5-25"><span class="linenos" data-linenos="25 "></span></a>docker<span class="w"> </span>rm<span class="w"> </span>container_id
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26"></a><a href="#__codelineno-5-26"><span class="linenos" data-linenos="26 "></span></a>docker<span class="w"> </span>stop<span class="w"> </span>container_id
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27"></a><a href="#__codelineno-5-27"><span class="linenos" data-linenos="27 "></span></a>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28"></a><a href="#__codelineno-5-28"><span class="linenos" data-linenos="28 "></span></a><span class="c1"># run时添加volume</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29"></a><a href="#__codelineno-5-29"><span class="linenos" data-linenos="29 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-v<span class="w"> </span>volume_name:container_folder_path<span class="w"> </span>username/image_name:tag_version
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30"></a><a href="#__codelineno-5-30"><span class="linenos" data-linenos="30 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-v<span class="w"> </span>local_folder_path:container_folder_path<span class="w"> </span>username/image_name:tag_version
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31"></a><a href="#__codelineno-5-31"><span class="linenos" data-linenos="31 "></span></a>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32"></a><a href="#__codelineno-5-32"><span class="linenos" data-linenos="32 "></span></a><span class="c1"># --restart string                   Restart policy to apply when a container exits (default &quot;no&quot;)</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33"></a><a href="#__codelineno-5-33"><span class="linenos" data-linenos="33 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>--restart<span class="w">  </span>username/image_name:tag_version
</span></code></pre></div>
<h3 id="dockerfile">Dockerfile<a class="headerlink" href="#dockerfile" title="Permanent link">&para;</a></h3>
<h4 id="_4">作用<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>Dockerfile 的目的是构建一个可复用的镜像</p>
<h4 id="_5">官方文档<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://docs.docker.com/get-started/">https://docs.docker.com/get-started/</a></li>
<li><a href="https://docs.docker.com/reference/dockerfile/">https://docs.docker.com/reference/dockerfile/</a></li>
<li><a href="https://docs.docker.com/develop/dev-best-practices/">https://docs.docker.com/develop/dev-best-practices/</a></li>
<li><a href="https://docs.docker.com/develop/develop-images/instructions/">https://docs.docker.com/develop/develop-images/instructions/</a></li>
<li><a href="https://docs.docker.com/storage/">https://docs.docker.com/storage/</a></li>
</ul>
<h4 id="dockerfile_1">Dockerfile 关键字<a class="headerlink" href="#dockerfile_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Instruction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ADD</td>
<td>Add local or remote files and directories.</td>
</tr>
<tr>
<td>ARG</td>
<td>Use build-time variables.</td>
</tr>
<tr>
<td>CMD</td>
<td>Specify default commands.</td>
</tr>
<tr>
<td>COPY</td>
<td>Copy files and directories.</td>
</tr>
<tr>
<td>ENTRYPOINT</td>
<td>Specify default executable.</td>
</tr>
<tr>
<td>ENV</td>
<td>Set environment variables.</td>
</tr>
<tr>
<td>EXPOSE</td>
<td>Describe which ports your application is listening on.</td>
</tr>
<tr>
<td>FROM</td>
<td>Create a new build stage from a base image.</td>
</tr>
<tr>
<td>HEALTHCHECK</td>
<td>Check a container's health on startup.</td>
</tr>
<tr>
<td>LABEL</td>
<td>Add metadata to an image.</td>
</tr>
<tr>
<td>MAINTAINER</td>
<td>Specify the author of an image.</td>
</tr>
<tr>
<td>ONBUILD</td>
<td>Specify instructions for when the image is used in a build.</td>
</tr>
<tr>
<td>RUN</td>
<td>Execute build commands.</td>
</tr>
<tr>
<td>SHELL</td>
<td>Set the default shell of an image.</td>
</tr>
<tr>
<td>STOPSIGNAL</td>
<td>Specify the system call signal for exiting a container.</td>
</tr>
<tr>
<td>USER</td>
<td>Set user and group ID.</td>
</tr>
<tr>
<td>VOLUME</td>
<td>Create volume mounts.</td>
</tr>
<tr>
<td>WORKDIR</td>
<td>Change working directory.</td>
</tr>
</tbody>
</table>
<h5 id="workdir">WORKDIR<a class="headerlink" href="#workdir" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th>常用路径</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>/app</td>
<td>简单,快捷</td>
</tr>
<tr>
<td>/usr/local</td>
<td>python和python包的默认安装路径,</td>
</tr>
<tr>
<td>/var/www</td>
<td>用于托管静态网站</td>
</tr>
</tbody>
</table>
<h4 id="_6">基础镜像<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<ul>
<li>轻量级的 Linux 发行版</li>
<li>slim(下载工具apt 300MB)<ul>
<li>apt install xxx</li>
<li>apt remove xxx</li>
</ul>
</li>
<li>alpine(下载工具apk 8MB)<ul>
<li>apk add xxx</li>
<li>apk del xxx</li>
</ul>
</li>
<li>busybox(4MB)</li>
</ul>
<h4 id="dockerfile_2">Dockerfile示例<a class="headerlink" href="#dockerfile_2" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><a href="#__codelineno-6-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># 开发容器时, 为了防止容器挂掉, 可以使用以下两个命令</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><a href="#__codelineno-6-2"><span class="linenos" data-linenos="2 "></span></a>tail<span class="w"> </span>-f<span class="w"> </span>/dev/null
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><a href="#__codelineno-6-3"><span class="linenos" data-linenos="3 "></span></a>sleep<span class="w"> </span>infinity
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><a href="#__codelineno-6-4"><span class="linenos" data-linenos="4 "></span></a><span class="c1"># 例如:</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><a href="#__codelineno-6-5"><span class="linenos" data-linenos="5 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>image_name<span class="w"> </span>tail<span class="w"> </span>-f<span class="w"> </span>/dev/null
</span></code></pre></div>
<ol>
<li>python项目的Dockerfile</li>
</ol>
<div class="language-Dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><a href="#__codelineno-7-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="k">FROM</span><span class="w"> </span><span class="s">python:3</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a><a href="#__codelineno-7-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><a href="#__codelineno-7-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/usr/src/app</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><a href="#__codelineno-7-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><a href="#__codelineno-7-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="k">COPY</span><span class="w"> </span>requirements.txt<span class="w"> </span>./
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><a href="#__codelineno-7-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--no-cache-dir<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><a href="#__codelineno-7-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><a href="#__codelineno-7-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="k">COPY</span><span class="w"> </span>.<span class="w"> </span>.
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><a href="#__codelineno-7-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="c"># ENTRYPOINT 是容器的默认启动文件(执行一系列命令), CMD 是容器的默认启动命令, CMD 给 ENTRYPOINT 传递参数</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><a href="#__codelineno-7-10"><span class="linenos" data-linenos="10 "></span></a><span class="c"># ENTRYPOINT [&quot;sh&quot;, &quot;./entrypoint.sh&quot;]</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><a href="#__codelineno-7-11"><span class="linenos" data-linenos="11 "></span></a><span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sh&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;-c&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tail -f /dev/null&quot;</span><span class="p">]</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a><a href="#__codelineno-7-12"><span class="linenos" data-linenos="12 "></span></a><span class="c"># CMD [ &quot;python&quot;, &quot;./your-daemon-or-script.py&quot; ]</span>
</span></code></pre></div>
<ol>
<li>python项目的entrypoint.sh文件</li>
</ol>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><a href="#__codelineno-8-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a><a href="#__codelineno-8-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><a href="#__codelineno-8-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;start sh!!!!!!!&quot;</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a><a href="#__codelineno-8-4"><span class="linenos" data-linenos=" 4 "></span></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><a href="#__codelineno-8-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="c1"># pip freeze &gt; requirements.txt</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a><a href="#__codelineno-8-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># django-admin startproject pj1</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a><a href="#__codelineno-8-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a><a href="#__codelineno-8-8"><span class="linenos" data-linenos=" 8 "></span></a>python<span class="w"> </span>manage.py<span class="w"> </span>migrate
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a><a href="#__codelineno-8-9"><span class="linenos" data-linenos=" 9 "></span></a>python<span class="w"> </span>manage.py<span class="w"> </span>collectstatic<span class="w"> </span>--noinput
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10"></a><a href="#__codelineno-8-10"><span class="linenos" data-linenos="10 "></span></a>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11"></a><a href="#__codelineno-8-11"><span class="linenos" data-linenos="11 "></span></a><span class="c1"># python manage.py runserver 0.0.0.0:8000</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12"></a><a href="#__codelineno-8-12"><span class="linenos" data-linenos="12 "></span></a>gunicorn<span class="w"> </span>-c<span class="w"> </span>gunicorn_conf.py<span class="w"> </span>pj1.wsgi
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13"></a><a href="#__codelineno-8-13"><span class="linenos" data-linenos="13 "></span></a>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14"></a><a href="#__codelineno-8-14"><span class="linenos" data-linenos="14 "></span></a><span class="c1"># 执行传入的命令或默认命令</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15"></a><a href="#__codelineno-8-15"><span class="linenos" data-linenos="15 "></span></a><span class="nb">exec</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</span></code></pre></div>
<ol>
<li>运行Dockerfile</li>
</ol>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><a href="#__codelineno-9-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># 有了Dockerfile后 需要build, run</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><a href="#__codelineno-9-2"><span class="linenos" data-linenos="2 "></span></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>username/image_name:tag_version<span class="w"> </span>.
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><a href="#__codelineno-9-3"><span class="linenos" data-linenos="3 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>-p<span class="w"> </span>local_ip:container_ip<span class="w"> </span>username/image_name:tag_version
</span></code></pre></div>
<ol>
<li>Docker Scout (优化Dockerfile)</li>
</ol>
<p>检查image漏洞的工具, 通常在build之后检查image</p>
<ol>
<li>Multi-stage builds 多阶段构建</li>
</ol>
<p>python还是推荐使用slim版本, alpine各种报错</p>
<p><a href="https://docs.docker.com/build/building/multi-stage/">https://docs.docker.com/build/building/multi-stage/</a></p>
<div class="language-Dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><a href="#__codelineno-10-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">FROM</span><span class="w"> </span><span class="s">xxx_big</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">builder</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a><a href="#__codelineno-10-2"><span class="linenos" data-linenos="2 "></span></a><span class="c"># build...</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><a href="#__codelineno-10-3"><span class="linenos" data-linenos="3 "></span></a><span class="k">FROM</span><span class="w"> </span><span class="s">xxx_small</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s">final</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><a href="#__codelineno-10-4"><span class="linenos" data-linenos="4 "></span></a><span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>path1<span class="w"> </span>path1
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><a href="#__codelineno-10-5"><span class="linenos" data-linenos="5 "></span></a><span class="k">COPY</span><span class="w"> </span>--from<span class="o">=</span>builder<span class="w"> </span>path2<span class="w"> </span>path2
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><a href="#__codelineno-10-6"><span class="linenos" data-linenos="6 "></span></a><span class="c"># run...</span>
</span></code></pre></div>
<h5 id="port">多个port绑定的作用<a class="headerlink" href="#port" title="Permanent link">&para;</a></h5>
<ul>
<li>不同服务</li>
<li>负载均衡</li>
<li>debug和测试</li>
<li>尽量少的绑定端口, 外部不使用时,不绑定</li>
</ul>
<h3 id="volume-bind-mount">Volume 和 Bind Mount<a class="headerlink" href="#volume-bind-mount" title="Permanent link">&para;</a></h3>
<p>Docker 不允许直接将一个容器目录同时挂载到宿主机目录和 Docker volume</p>
<ul>
<li>Bind Mount</li>
<li>本地文件夹:容器文件夹</li>
<li>本地文件:容器文件</li>
<li>Volume</li>
<li>volume_name:容器文件夹</li>
</ul>
<p>TODO:
<div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><a href="#__codelineno-11-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a><a href="#__codelineno-11-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./frontend:/app</span><span class="w">        </span><span class="c1"># 将主机的 frontend 目录挂载到容器的 /app</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a><a href="#__codelineno-11-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/app/node_modules</span><span class="w">     </span><span class="c1"># 将容器内的 /app/node_modules 作为独立卷</span>
</span></code></pre></div></p>
<p>作用
1. 使用**共享卷**同步各个容器的数据
2. 使用卷同步本地和容器的数据</p>
<h4 id="user">user 和 权限<a class="headerlink" href="#user" title="Permanent link">&para;</a></h4>
<p>挂载目录时, 常常会遇到**权限问题**</p>
<ol>
<li>设置compose
  <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><a href="#__codelineno-12-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000:1000</span>
</span></code></pre></div></li>
</ol>
<p>即使设置了 user: 1000:1000, 可能还是会遇到权限问题. <strong>最好手动创建文件夹</strong>, 然后运行docker.</p>
<p>Docker 默认是 root，是因为它需要访问很多内核级别的功能
  挂载目录是在容器运行之前就准备好的
  指定的 user 是容器启动之后才生效的！
  创建宿主机目录这个动作，是 Docker 守护进程（默认是 root）在做的，和设置的容器用户没关系！</p>
<ol>
<li>修改文件权限
  <div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><a href="#__codelineno-13-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>chown<span class="w"> </span>-R<span class="w"> </span><span class="k">$(</span>id<span class="w"> </span>-u<span class="k">)</span>:<span class="k">$(</span>id<span class="w"> </span>-g<span class="k">)</span><span class="w"> </span>.
</span></code></pre></div></li>
</ol>
<h4 id="volume">Volume的数据迁移<a class="headerlink" href="#volume" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.docker.com/desktop/use-desktop/volumes/">https://docs.docker.com/desktop/use-desktop/volumes/</a></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>scp</td>
<td>简单的文件复制, 适合一次性的数据copy</td>
</tr>
<tr>
<td>rsync</td>
<td>增量传输, 断点续传, 适合持续的数据同步</td>
</tr>
</tbody>
</table>
<p>假设想把 old_volume 改称 new_volume</p>
<p><div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><a href="#__codelineno-14-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># bk</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a><a href="#__codelineno-14-2"><span class="linenos" data-linenos="2 "></span></a>sudo<span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span>immich_model-cache:/data<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/backup<span class="w"> </span>busybox<span class="w"> </span>tar<span class="w"> </span>cvf<span class="w"> </span>/backup/data.tar<span class="w"> </span>/data
</span></code></pre></div>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><a href="#__codelineno-15-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># 1. old_volume -&gt; old_volume.tar.gz</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a><a href="#__codelineno-15-2"><span class="linenos" data-linenos="2 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span>old_volume:/volume<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/backup<span class="w"> </span>busybox<span class="w"> </span>tar<span class="w"> </span>-czvf<span class="w"> </span>/backup/old_volume.tar.gz<span class="w"> </span>-C<span class="w"> </span>/volume<span class="w"> </span>.
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a><a href="#__codelineno-15-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># 2. copy tar.gz的两种方式</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a><a href="#__codelineno-15-4"><span class="linenos" data-linenos="4 "></span></a>scp<span class="w"> </span>old_volume.tar.gz<span class="w"> </span>username@IP:/home/username/
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a><a href="#__codelineno-15-5"><span class="linenos" data-linenos="5 "></span></a><span class="c1"># rsync -avz volume1.tar.gz volume2.tar.gz username@IP:/home/username/</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a><a href="#__codelineno-15-6"><span class="linenos" data-linenos="6 "></span></a><span class="c1"># 3. create new_volume</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7"></a><a href="#__codelineno-15-7"><span class="linenos" data-linenos="7 "></span></a>docker<span class="w"> </span>volume<span class="w"> </span>create<span class="w"> </span>new_volume
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8"></a><a href="#__codelineno-15-8"><span class="linenos" data-linenos="8 "></span></a><span class="c1"># 4. old_volume.tar.gz -&gt; new_volume</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9"></a><a href="#__codelineno-15-9"><span class="linenos" data-linenos="9 "></span></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-v<span class="w"> </span>new_volume:/volume<span class="w"> </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/backup<span class="w"> </span>busybox<span class="w"> </span>tar<span class="w"> </span>-xzvf<span class="w"> </span>/backup/old_volume.tar.gz<span class="w"> </span>-C<span class="w"> </span>/volume
</span></code></pre></div></p>
<h2 id="_7">进阶使用<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="container-networking">Container Networking<a class="headerlink" href="#container-networking" title="Permanent link">&para;</a></h3>
<p>相关文档:</p>
<ul>
<li><a href="https://docs.docker.com/engine/network/">https://docs.docker.com/engine/network/</a></li>
<li><a href="https://docs.docker.com/engine/network/drivers/">https://docs.docker.com/engine/network/drivers/</a></li>
<li><a href="https://docs.docker.com/desktop/features/networking/">https://docs.docker.com/desktop/features/networking/</a></li>
</ul>
<p>如果两个容器位于同一网络上，它们可以相互通信。如果他们不是，他们就不能</p>
<p>网络Drivers:</p>
<table>
<thead>
<tr>
<th>Driver</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bridge</code></td>
<td>The default network driver.</td>
</tr>
<tr>
<td><code>host</code></td>
<td><strong>Remove network isolation</strong> between the container and the Docker host.</td>
</tr>
<tr>
<td><code>none</code></td>
<td><strong>Completely isolate</strong> a container from the host and other containers.</td>
</tr>
<tr>
<td><code>overlay</code></td>
<td>Overlay networks connect <strong>multiple Docker daemons</strong> together.</td>
</tr>
<tr>
<td><code>ipvlan</code></td>
<td>IPvlan networks provide full control over both IPv4 and IPv6 addressing.</td>
</tr>
<tr>
<td><code>macvlan</code></td>
<td>Assign a <strong>MAC address</strong> to a container.</td>
</tr>
</tbody>
</table>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><a href="#__codelineno-16-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># 首先创建一个外部网络</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a><a href="#__codelineno-16-2"><span class="linenos" data-linenos=" 2 "></span></a>docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>web_network
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><a href="#__codelineno-16-3"><span class="linenos" data-linenos=" 3 "></span></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><a href="#__codelineno-16-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1"># 查看网络详情</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a><a href="#__codelineno-16-5"><span class="linenos" data-linenos=" 5 "></span></a>docker<span class="w"> </span>network<span class="w"> </span>inspect<span class="w"> </span>web_network
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><a href="#__codelineno-16-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><a href="#__codelineno-16-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c1"># 测试容器间连接</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><a href="#__codelineno-16-8"><span class="linenos" data-linenos=" 8 "></span></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>nginx-container<span class="w"> </span>ping<span class="w"> </span>site1-web
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><a href="#__codelineno-16-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><a href="#__codelineno-16-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1"># 用户删除网络</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><a href="#__codelineno-16-11"><span class="linenos" data-linenos="11 "></span></a>docker<span class="w"> </span>network<span class="w"> </span>rm<span class="w"> </span>web_network
</span></code></pre></div>
<div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><a href="#__codelineno-17-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># nginx的 docker-compose.yaml</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a><a href="#__codelineno-17-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="nt">services</span><span class="p">:</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a><a href="#__codelineno-17-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">  </span><span class="nt">nginx</span><span class="p">:</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a><a href="#__codelineno-17-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:alpine</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a><a href="#__codelineno-17-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a><a href="#__codelineno-17-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web_network</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><a href="#__codelineno-17-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a><a href="#__codelineno-17-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="nt">networks</span><span class="p">:</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a><a href="#__codelineno-17-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="nt">web_network</span><span class="p">:</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a><a href="#__codelineno-17-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">    </span><span class="c1"># 声明这是一个外部网络</span>
</span></code></pre></div>
<h4 id="_8">网络解析<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p>容器访问主机的ip: <code>http://host.docker.internal</code></p>
<p>Docker 会使用默认的 bridge 网络, 容器默认连接到这个网络</p>
<p>默认 bridge 网络：
- 当你直接用 docker run 启动容器时
- 容器自动连接到 bridge 网络
- IP 地址在 172.17.0.0/16 范围内
- 没有自动的 DNS 解析（容器间不能用名字互相访问）</p>
<p>自定义网络（如我们的 api-network）：
- 使用 docker-compose 或手动创建的网络
- 有自动的 DNS 解析
- 可以看到有 Aliases（别名）列表
- IP 地址在不同的范围（192.168.32.0/20）</p>
<p>默认 bridge：只能用 IP 地址通信
自定义网络：可以用服务名通信</p>
<p>Docker DNS 会将服务名(service name)解析到对应的容器
如果服务有多个实例，会自动负载均衡</p>
<h3 id="docker-compose">Docker Compose<a class="headerlink" href="#docker-compose" title="Permanent link">&para;</a></h3>
<h4 id="_9">作用<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<p>docker-compose.yaml 的目的是编排多个服务(container)</p>
<h4 id="_10">官方文档<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<ul>
<li><a href="https://docs.docker.com/reference/compose-file/">https://docs.docker.com/reference/compose-file/</a></li>
<li><a href="https://docs.docker.com/compose/compose-file/05-services/#simple-example">https://docs.docker.com/compose/compose-file/05-services/#simple-example</a></li>
<li>开发 <a href="https://docs.docker.com/compose/how-tos/file-watch/#use-watch">https://docs.docker.com/compose/how-tos/file-watch/#use-watch</a></li>
<li>生产 <a href="https://docs.docker.com/compose/how-tos/production/">https://docs.docker.com/compose/how-tos/production/</a></li>
</ul>
<h4 id="yaml">yaml文件<a class="headerlink" href="#yaml" title="Permanent link">&para;</a></h4>
<h5 id="_11">书写规则<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h5>
<ul>
<li>缩进 两个空格表示一个层级的</li>
<li>字典 k:v</li>
<li>列表 -</li>
</ul>
<h5 id="yamljson">yaml对比json<a class="headerlink" href="#yamljson" title="Permanent link">&para;</a></h5>
<table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th><strong>YAML</strong></th>
<th><strong>JSON</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>文件扩展名</td>
<td><code>.yaml</code> or <code>.yml</code></td>
<td><code>.json</code></td>
</tr>
<tr>
<td><strong>可读性</strong></td>
<td>高，可读性强，类似自然语言</td>
<td>适中，结构较为严谨，但大量标点符号可能降低可读性</td>
</tr>
<tr>
<td><strong>语法复杂度</strong></td>
<td>简洁，使用缩进表示层级，不需要引号、逗号、括号</td>
<td>语法严格，必须使用大括号 <code>{}</code>、方括号 <code>[]</code> 和逗号 <code>,</code></td>
</tr>
<tr>
<td><strong>注释支持</strong></td>
<td>支持（使用 <code>#</code>）</td>
<td>不支持</td>
</tr>
<tr>
<td><strong>数据类型支持</strong></td>
<td>原生支持布尔值、整数、浮点数、字符串、列表、字典等</td>
<td>支持类似数据类型，但字符串需要用引号包裹</td>
</tr>
<tr>
<td><strong>兼容性</strong></td>
<td>需要专门的解析器</td>
<td>原生支持 JavaScript，对其他语言也很友好</td>
</tr>
<tr>
<td><strong>用途</strong></td>
<td>常用于配置文件（如 Docker Compose、Kubernetes 等）</td>
<td>常用于数据交换、API 响应等</td>
</tr>
<tr>
<td>文件大小</td>
<td>相对较小，由于省略了大量标点，文件内容通常更少</td>
<td>相对较大，因标点符号和引号较多而显得冗长</td>
</tr>
<tr>
<td><strong>复杂数据结构支持</strong></td>
<td>非常灵活，可以轻松表示复杂的嵌套数据结构</td>
<td>适中，但可能在嵌套层级较多时显得冗长</td>
</tr>
<tr>
<td><strong>学习曲线</strong></td>
<td>需要一定学习时间，特别是处理复杂场景时</td>
<td>学习难度较低，语法简单明确</td>
</tr>
<tr>
<td><strong>主要应用场景</strong></td>
<td>配置文件、数据序列化、模板等</td>
<td>数据交换、配置文件、Web API、存储对象等</td>
</tr>
</tbody>
</table>
<h4 id="composeyaml">compose.yaml的书写规则<a class="headerlink" href="#composeyaml" title="Permanent link">&para;</a></h4>
<ul>
<li>顶级元素</li>
<li>services</li>
<li>network</li>
<li>volumes</li>
<li>configs</li>
<li>secrets</li>
</ul>
<h4 id="_12">环境变量<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<p>相关文档</p>
<ul>
<li><a href="https://docs.docker.com/compose/environment-variables/set-environment-variables/">https://docs.docker.com/compose/environment-variables/set-environment-variables/</a></li>
<li><a href="https://docs.docker.com/compose/environment-variables/variable-interpolation/">https://docs.docker.com/compose/environment-variables/variable-interpolation/</a></li>
</ul>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><a href="#__codelineno-18-1"><span class="linenos" data-linenos="1 "></span></a># comments...
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><a href="#__codelineno-18-2"><span class="linenos" data-linenos="2 "></span></a>AA=1
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><a href="#__codelineno-18-3"><span class="linenos" data-linenos="3 "></span></a>BB=2
</span></code></pre></div>
<div class="language-dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><a href="#__codelineno-19-1"><span class="linenos" data-linenos=" 1 "></span></a>services:
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><a href="#__codelineno-19-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span>web:
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><a href="#__codelineno-19-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">    </span>image:<span class="w"> </span>nginx
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a><a href="#__codelineno-19-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span>depends_on:
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a><a href="#__codelineno-19-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">      </span>-<span class="w"> </span>api
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a><a href="#__codelineno-19-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">    </span>#<span class="w"> </span>在<span class="w"> </span>env_file<span class="w"> </span>属性中指定的<span class="w"> </span>.env<span class="w"> </span>文件的路径是相对于<span class="w"> </span>compose.yml<span class="w"> </span>文件的位置的,<span class="w"> </span>优先级&lt;<span class="w"> </span>environment,<span class="w"> </span>文件中所有定义的变量都传给service
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a><a href="#__codelineno-19-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">    </span>env_file:
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><a href="#__codelineno-19-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">      </span>-<span class="w"> </span>.env
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a><a href="#__codelineno-19-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">      </span>-<span class="w"> </span>.env.dev
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a><a href="#__codelineno-19-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span>environment:
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a><a href="#__codelineno-19-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">      </span>-<span class="w"> </span><span class="nv">API_URL</span><span class="o">=</span>http://api:8080<span class="w">  </span>#<span class="w"> </span>直接使用服务名<span class="w"> </span>api<span class="w"> </span>作为主机名,<span class="w"> </span>服务名称会自动解析为对应的容器<span class="w"> </span>IP<span class="w"> </span>地址
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a><a href="#__codelineno-19-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">      </span>-<span class="w"> </span><span class="nv">AA</span><span class="o">=</span><span class="si">${</span><span class="nv">AA</span><span class="si">}</span><span class="w"> </span>#<span class="w"> </span>compose文件自动读取.env的变量
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a><a href="#__codelineno-19-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">      </span>-<span class="w"> </span><span class="nv">BB</span><span class="o">=</span><span class="si">${</span><span class="nv">BB</span><span class="si">}</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14"></a><a href="#__codelineno-19-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">      </span>-<span class="w"> </span><span class="nv">DEBUG</span><span class="o">=</span><span class="si">${</span><span class="nv">DEBUG</span><span class="k">:-</span><span class="nv">false</span><span class="si">}</span><span class="w"> </span>#<span class="w"> </span>默认值为false
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15"></a><a href="#__codelineno-19-15"><span class="linenos" data-linenos="15 "></span></a>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16"></a><a href="#__codelineno-19-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">  </span>api:
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17"></a><a href="#__codelineno-19-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">    </span>image:<span class="w"> </span>api-service
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18"></a><a href="#__codelineno-19-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span>ports:
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19"></a><a href="#__codelineno-19-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">      </span>-<span class="w"> </span><span class="s2">&quot;8080:8080&quot;</span>
</span></code></pre></div>
<h5 id="env">.env书写格式<a class="headerlink" href="#env" title="Permanent link">&para;</a></h5>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><a href="#__codelineno-20-1"><span class="linenos" data-linenos="1 "></span></a># mysql
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a><a href="#__codelineno-20-2"><span class="linenos" data-linenos="2 "></span></a>MYSQL_ROOT_PASSWORD=111
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a><a href="#__codelineno-20-3"><span class="linenos" data-linenos="3 "></span></a>MYSQL_DATABASE=mydb
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a><a href="#__codelineno-20-4"><span class="linenos" data-linenos="4 "></span></a>MYSQL_USER=user1
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a><a href="#__codelineno-20-5"><span class="linenos" data-linenos="5 "></span></a>MYSQL_PASSWORD=444
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a><a href="#__codelineno-20-6"><span class="linenos" data-linenos="6 "></span></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7"></a><a href="#__codelineno-20-7"><span class="linenos" data-linenos="7 "></span></a># web
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8"></a><a href="#__codelineno-20-8"><span class="linenos" data-linenos="8 "></span></a>DB_HOST=db
</span></code></pre></div>
<h4 id="_13">查看实际运行的配置文件<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><a href="#__codelineno-21-1"><span class="linenos" data-linenos="1 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>config
</span></code></pre></div>
<h4 id="composeyaml_1">创建 compose.yaml<a class="headerlink" href="#composeyaml_1" title="Permanent link">&para;</a></h4>
<div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><a href="#__codelineno-22-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="nt">services</span><span class="p">:</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><a href="#__codelineno-22-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="nt">redis</span><span class="p">:</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a><a href="#__codelineno-22-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a><a href="#__codelineno-22-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a><a href="#__codelineno-22-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-data:/data</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a><a href="#__codelineno-22-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7"></a><a href="#__codelineno-22-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;6379:6379&#39;</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8"></a><a href="#__codelineno-22-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="nt">web1</span><span class="p">:</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9"></a><a href="#__codelineno-22-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">on-failure</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10"></a><a href="#__codelineno-22-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./web</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11"></a><a href="#__codelineno-22-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web1</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12"></a><a href="#__codelineno-22-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13"></a><a href="#__codelineno-22-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;81:5000&#39;</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14"></a><a href="#__codelineno-22-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">  </span><span class="nt">web2</span><span class="p">:</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15"></a><a href="#__codelineno-22-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">on-failure</span>
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16"></a><a href="#__codelineno-22-16"><span class="linenos" data-linenos="16 "></span></a><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./web</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17"></a><a href="#__codelineno-22-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">    </span><span class="nt">hostname</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web2</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18"></a><a href="#__codelineno-22-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19"></a><a href="#__codelineno-22-19"><span class="linenos" data-linenos="19 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;82:5000&#39;</span>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20"></a><a href="#__codelineno-22-20"><span class="linenos" data-linenos="20 "></span></a><span class="nt">volumes</span><span class="p">:</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21"></a><a href="#__codelineno-22-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">  </span><span class="nt">redis-data</span><span class="p">:</span>
</span></code></pre></div>
<p>command 覆盖 Dockerfile 中的 CMD，适用于特定服务的启动配置。</p>
<h4 id="_14">常用命令<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><a href="#__codelineno-23-1"><span class="linenos" data-linenos=" 1 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>--help
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><a href="#__codelineno-23-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="c1"># 生成image, container, build 作用: 重新构建image</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><a href="#__codelineno-23-3"><span class="linenos" data-linenos=" 3 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>--build
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a><a href="#__codelineno-23-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="c1"># 后台运行，可以重复运行！ Docker Compose 会自动检测变化，并只重新构建和启动有变化的服务</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><a href="#__codelineno-23-5"><span class="linenos" data-linenos=" 5 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>--build<span class="w"> </span>-d
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><a href="#__codelineno-23-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># 停止container</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a><a href="#__codelineno-23-7"><span class="linenos" data-linenos=" 7 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>stop
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a><a href="#__codelineno-23-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># 具体服务</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a><a href="#__codelineno-23-9"><span class="linenos" data-linenos=" 9 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>restart<span class="w"> </span>service_name
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a><a href="#__codelineno-23-10"><span class="linenos" data-linenos="10 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>stop<span class="w"> </span>service_name
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a><a href="#__codelineno-23-11"><span class="linenos" data-linenos="11 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>start<span class="w"> </span>service_name
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a><a href="#__codelineno-23-12"><span class="linenos" data-linenos="12 "></span></a><span class="c1"># 销毁container， network</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a><a href="#__codelineno-23-13"><span class="linenos" data-linenos="13 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>down
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a><a href="#__codelineno-23-14"><span class="linenos" data-linenos="14 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>--remove-orphans
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a><a href="#__codelineno-23-15"><span class="linenos" data-linenos="15 "></span></a><span class="c1"># 销毁container， network, volume</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a><a href="#__codelineno-23-16"><span class="linenos" data-linenos="16 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>-v
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a><a href="#__codelineno-23-17"><span class="linenos" data-linenos="17 "></span></a><span class="c1"># 开发环境,查看实时变化, 需要在compose.yaml添加 develop, watch</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a><a href="#__codelineno-23-18"><span class="linenos" data-linenos="18 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>watch
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a><a href="#__codelineno-23-19"><span class="linenos" data-linenos="19 "></span></a><span class="c1"># 交互调试, exit退出此模式</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a><a href="#__codelineno-23-20"><span class="linenos" data-linenos="20 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>service_name<span class="w"> </span>/bin/bash
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21"></a><a href="#__codelineno-23-21"><span class="linenos" data-linenos="21 "></span></a><span class="c1"># 查看实际运行的配置文件</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22"></a><a href="#__codelineno-23-22"><span class="linenos" data-linenos="22 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>config
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23"></a><a href="#__codelineno-23-23"><span class="linenos" data-linenos="23 "></span></a><span class="c1"># 指定环境变量文件</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24"></a><a href="#__codelineno-23-24"><span class="linenos" data-linenos="24 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>--env-file<span class="w"> </span>.env.production<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25"></a><a href="#__codelineno-23-25"><span class="linenos" data-linenos="25 "></span></a><span class="c1"># 指定compose文件</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26"></a><a href="#__codelineno-23-26"><span class="linenos" data-linenos="26 "></span></a>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose.yml.withdb<span class="w"> </span>up<span class="w"> </span>-d
</span></code></pre></div>
<p>tips:</p>
<p>有时候<code>docker compose up</code> 运行 报错,  手动拉image可以解决大部分问题 <code>docker pull xxxx</code>.</p>
<h4 id="restart">restart<a class="headerlink" href="#restart" title="Permanent link">&para;</a></h4>
<p>Restart policies only apply to containers.</p>
<p><a href="https://docs.docker.com/engine/containers/start-containers-automatically/">https://docs.docker.com/engine/containers/start-containers-automatically/</a></p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>no</td>
<td>Don't automatically restart the container. (Default)</td>
</tr>
<tr>
<td></td>
<td>不自动重启容器。（默认）</td>
</tr>
<tr>
<td>on-failure[:max-retries]</td>
<td>Restart the container if it exits due to an error, which manifests as a non-zero exit code. Optionally, limit the number of times the Docker daemon attempts to restart the container using the :max-retries option. The on-failure policy only prompts a restart if the container exits with a failure. It doesn't restart the container if the daemon restarts</td>
</tr>
<tr>
<td></td>
<td>仅当容器因失败而退出时，失败策略才会提示重新启动。</td>
</tr>
<tr>
<td>always</td>
<td>Always restart the container if it stops. If it's manually stopped, it's restarted only when Docker daemon restarts or the container itself is manually restarted. (See the second bullet listed in restart policy details)</td>
</tr>
<tr>
<td></td>
<td>重启容器</td>
</tr>
<tr>
<td>unless-stopped</td>
<td>Similar to always, except that when the container is stopped (manually or otherwise), it isn't restarted even after Docker daemon restarts.</td>
</tr>
<tr>
<td></td>
<td>Docker 守护进程重启后它不会重启</td>
</tr>
</tbody>
</table>
<h4 id="healthcheck">healthcheck<a class="headerlink" href="#healthcheck" title="Permanent link">&para;</a></h4>
<p>TODO:</p>
<h4 id="deploy-replicas">deploy, replicas<a class="headerlink" href="#deploy-replicas" title="Permanent link">&para;</a></h4>
<div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><a href="#__codelineno-24-1"><span class="linenos" data-linenos="1 "></span></a><span class="nt">deploy</span><span class="p">:</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><a href="#__codelineno-24-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">      </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span></code></pre></div>
<h4 id="volumes">volumes<a class="headerlink" href="#volumes" title="Permanent link">&para;</a></h4>
<div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><a href="#__codelineno-25-1"><span class="linenos" data-linenos="1 "></span></a><span class="l l-Scalar l-Scalar-Plain">driver_opts</span>
</span></code></pre></div>
<h3 id="docker-contenxt">Docker Contenxt<a class="headerlink" href="#docker-contenxt" title="Permanent link">&para;</a></h3>
<p>本地机器上可以切换 为使用远程电脑的docker. 据说比ssh 好用</p>
<h2 id="_15">项目目录结构推荐<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><a href="#__codelineno-26-1"><span class="linenos" data-linenos=" 1 "></span></a>myproject/
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><a href="#__codelineno-26-2"><span class="linenos" data-linenos=" 2 "></span></a>│
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a><a href="#__codelineno-26-3"><span class="linenos" data-linenos=" 3 "></span></a>├──<span class="w"> </span>.git/<span class="w">                 </span><span class="c1"># Git repository metadata</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a><a href="#__codelineno-26-4"><span class="linenos" data-linenos=" 4 "></span></a>├──<span class="w"> </span>.gitignore<span class="w">            </span><span class="c1"># Git ignore file</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><a href="#__codelineno-26-5"><span class="linenos" data-linenos=" 5 "></span></a>├──<span class="w"> </span>.dockerignore<span class="w">         </span><span class="c1"># Docker ignore file</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a><a href="#__codelineno-26-6"><span class="linenos" data-linenos=" 6 "></span></a>├──<span class="w"> </span>docker-compose.yml<span class="w">    </span><span class="c1"># Docker Compose configuration file</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><a href="#__codelineno-26-7"><span class="linenos" data-linenos=" 7 "></span></a>├──<span class="w"> </span>web/<span class="w">                  </span><span class="c1"># Web服务（如Django）的目录</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a><a href="#__codelineno-26-8"><span class="linenos" data-linenos=" 8 "></span></a>│<span class="w">   </span>├──<span class="w"> </span>Dockerfile<span class="w">        </span><span class="c1"># Web服务的Dockerfile</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><a href="#__codelineno-26-9"><span class="linenos" data-linenos=" 9 "></span></a>│<span class="w">   </span>├──<span class="w"> </span>requirements.txt<span class="w">  </span><span class="c1"># Python依赖文件</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a><a href="#__codelineno-26-10"><span class="linenos" data-linenos="10 "></span></a>│<span class="w">   </span>├──<span class="w"> </span>manage.py<span class="w">         </span><span class="c1"># Django管理脚本</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a><a href="#__codelineno-26-11"><span class="linenos" data-linenos="11 "></span></a>│<span class="w">   </span>└──<span class="w"> </span>myproject/<span class="w">        </span><span class="c1"># Django项目目录</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12"></a><a href="#__codelineno-26-12"><span class="linenos" data-linenos="12 "></span></a>│<span class="w">       </span>├──<span class="w"> </span>__init__.py
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13"></a><a href="#__codelineno-26-13"><span class="linenos" data-linenos="13 "></span></a>│<span class="w">       </span>├──<span class="w"> </span>settings.py
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14"></a><a href="#__codelineno-26-14"><span class="linenos" data-linenos="14 "></span></a>│<span class="w">       </span>├──<span class="w"> </span>urls.py
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15"></a><a href="#__codelineno-26-15"><span class="linenos" data-linenos="15 "></span></a>│<span class="w">       </span>└──<span class="w"> </span>wsgi.py
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16"></a><a href="#__codelineno-26-16"><span class="linenos" data-linenos="16 "></span></a>├──<span class="w"> </span>db/<span class="w">                   </span><span class="c1"># 数据库服务的目录（可选）</span>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17"></a><a href="#__codelineno-26-17"><span class="linenos" data-linenos="17 "></span></a>│<span class="w">   </span>├──<span class="w"> </span>Dockerfile<span class="w">        </span><span class="c1"># 数据库服务的Dockerfile（如自定义配置）</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18"></a><a href="#__codelineno-26-18"><span class="linenos" data-linenos="18 "></span></a>│<span class="w">   </span>└──<span class="w"> </span>init.sql<span class="w">          </span><span class="c1"># 初始化数据库的SQL脚本（可选）</span>
</span></code></pre></div>
<h2 id="cicd">CI/CD<a class="headerlink" href="#cicd" title="Permanent link">&para;</a></h2>
<h3 id="_16">主要构成<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<ul>
<li>持续集成（Continuous Integration，CI）, 执行 testcase</li>
<li>持续交付（Continuous Delivery，CD）, 生成 docker image</li>
<li>持续部署（Continuous Deployment，CD）, 使用ssh, 登录服务器, 更新代码和image, 启动服务</li>
</ul>
<h3 id="_17">工作流<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>git push -&gt; run testcase -&gt; build image -&gt; ssh deploy -&gt; 自动监控 -&gt; 自动回滚</p>
<h3 id="_18">原理<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>触发一系列命令, 执行自定义逻辑</p>
<h3 id="_19">分类<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<ul>
<li>github actions</li>
<li>gitlab ci/cd</li>
<li>jenkins</li>
</ul>
<h3 id="repo">手动推送到repo<a class="headerlink" href="#repo" title="Permanent link">&para;</a></h3>
<ol>
<li>登录</li>
</ol>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><a href="#__codelineno-27-1"><span class="linenos" data-linenos="1 "></span></a><span class="nb">export</span><span class="w"> </span><span class="nv">CR_PAT</span><span class="o">=</span>YOUR_TOKEN
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a><a href="#__codelineno-27-2"><span class="linenos" data-linenos="2 "></span></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$CR_PAT</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>login<span class="w"> </span>ghcr.io<span class="w"> </span>-u<span class="w"> </span>USERNAME<span class="w"> </span>--password-stdin
</span></code></pre></div>
<ol>
<li>命令
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><a href="#__codelineno-28-1"><span class="linenos" data-linenos="1 "></span></a>docker<span class="w"> </span>tag<span class="w"> </span>xxxx<span class="w"> </span>ghcr.io/github_id/image_name:tag_name
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a><a href="#__codelineno-28-2"><span class="linenos" data-linenos="2 "></span></a>docker<span class="w"> </span>push<span class="w"> </span>ghcr.io/github_id/image_name:tag_name
</span></code></pre></div></li>
</ol>
<h3 id="docker_3">docker 标签<a class="headerlink" href="#docker_3" title="Permanent link">&para;</a></h3>
<p>方便image版本回退</p>
<h3 id="image">为image设置时间辍<a class="headerlink" href="#image" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><a href="#__codelineno-29-1"><span class="linenos" data-linenos="1 "></span></a><span class="k">$(</span>date<span class="w"> </span>-u<span class="w"> </span>+<span class="s2">&quot;&quot;</span><span class="k">)</span>
</span></code></pre></div>
<h3 id="github-actionscicd">使用github actions来实现CI/CD的实际操作<a class="headerlink" href="#github-actionscicd" title="Permanent link">&para;</a></h3>
<ol>
<li>编写yaml文件定义逻辑</li>
</ol>
<p>github actions yaml文件demo
  <div class="language-yaml highlight"><span class="filename">YAML</span><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><a href="#__codelineno-30-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dp gpt</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><a href="#__codelineno-30-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><a href="#__codelineno-30-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="nt">on</span><span class="p">:</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a><a href="#__codelineno-30-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span><span class="nt">push</span><span class="p">:</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a><a href="#__codelineno-30-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">        </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;master&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a><a href="#__codelineno-30-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">    </span><span class="nt">pull_request</span><span class="p">:</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7"></a><a href="#__codelineno-30-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">        </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;master&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8"></a><a href="#__codelineno-30-8"><span class="linenos" data-linenos=" 8 "></span></a>
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9"></a><a href="#__codelineno-30-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="nt">jobs</span><span class="p">:</span>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10"></a><a href="#__codelineno-30-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="nt">build</span><span class="p">:</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11"></a><a href="#__codelineno-30-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12"></a><a href="#__codelineno-30-12"><span class="linenos" data-linenos="12 "></span></a>
</span><span id="__span-30-13"><a id="__codelineno-30-13" name="__codelineno-30-13"></a><a href="#__codelineno-30-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
</span><span id="__span-30-14"><a id="__codelineno-30-14" name="__codelineno-30-14"></a><a href="#__codelineno-30-14"><span class="linenos" data-linenos="14 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout code</span>
</span><span id="__span-30-15"><a id="__codelineno-30-15" name="__codelineno-30-15"></a><a href="#__codelineno-30-15"><span class="linenos" data-linenos="15 "></span></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v4</span>
</span><span id="__span-30-16"><a id="__codelineno-30-16" name="__codelineno-30-16"></a><a href="#__codelineno-30-16"><span class="linenos" data-linenos="16 "></span></a>
</span><span id="__span-30-17"><a id="__codelineno-30-17" name="__codelineno-30-17"></a><a href="#__codelineno-30-17"><span class="linenos" data-linenos="17 "></span></a><span class="w">      </span><span class="c1"># - name: Set up Docker Buildx</span>
</span><span id="__span-30-18"><a id="__codelineno-30-18" name="__codelineno-30-18"></a><a href="#__codelineno-30-18"><span class="linenos" data-linenos="18 "></span></a><span class="w">      </span><span class="c1">#   uses: docker/setup-buildx-action@v2</span>
</span><span id="__span-30-19"><a id="__codelineno-30-19" name="__codelineno-30-19"></a><a href="#__codelineno-30-19"><span class="linenos" data-linenos="19 "></span></a>
</span><span id="__span-30-20"><a id="__codelineno-30-20" name="__codelineno-30-20"></a><a href="#__codelineno-30-20"><span class="linenos" data-linenos="20 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Login to Docker Hub</span>
</span><span id="__span-30-21"><a id="__codelineno-30-21" name="__codelineno-30-21"></a><a href="#__codelineno-30-21"><span class="linenos" data-linenos="21 "></span></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/login-action@v3</span>
</span><span id="__span-30-22"><a id="__codelineno-30-22" name="__codelineno-30-22"></a><a href="#__codelineno-30-22"><span class="linenos" data-linenos="22 "></span></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
</span><span id="__span-30-23"><a id="__codelineno-30-23" name="__codelineno-30-23"></a><a href="#__codelineno-30-23"><span class="linenos" data-linenos="23 "></span></a><span class="w">          </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DOCKER_USERNAME }}</span>
</span><span id="__span-30-24"><a id="__codelineno-30-24" name="__codelineno-30-24"></a><a href="#__codelineno-30-24"><span class="linenos" data-linenos="24 "></span></a><span class="w">          </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.DOCKER_PASSWORD }}</span>
</span><span id="__span-30-25"><a id="__codelineno-30-25" name="__codelineno-30-25"></a><a href="#__codelineno-30-25"><span class="linenos" data-linenos="25 "></span></a>
</span><span id="__span-30-26"><a id="__codelineno-30-26" name="__codelineno-30-26"></a><a href="#__codelineno-30-26"><span class="linenos" data-linenos="26 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Login to ghrc</span>
</span><span id="__span-30-27"><a id="__codelineno-30-27" name="__codelineno-30-27"></a><a href="#__codelineno-30-27"><span class="linenos" data-linenos="27 "></span></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/login-action@v3</span>
</span><span id="__span-30-28"><a id="__codelineno-30-28" name="__codelineno-30-28"></a><a href="#__codelineno-30-28"><span class="linenos" data-linenos="28 "></span></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
</span><span id="__span-30-29"><a id="__codelineno-30-29" name="__codelineno-30-29"></a><a href="#__codelineno-30-29"><span class="linenos" data-linenos="29 "></span></a><span class="w">          </span><span class="nt">registry</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ghcr.io</span>
</span><span id="__span-30-30"><a id="__codelineno-30-30" name="__codelineno-30-30"></a><a href="#__codelineno-30-30"><span class="linenos" data-linenos="30 "></span></a><span class="w">          </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zhenda-hub</span>
</span><span id="__span-30-31"><a id="__codelineno-30-31" name="__codelineno-30-31"></a><a href="#__codelineno-30-31"><span class="linenos" data-linenos="31 "></span></a><span class="w">          </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GHCR_PASSWORD }}</span>
</span><span id="__span-30-32"><a id="__codelineno-30-32" name="__codelineno-30-32"></a><a href="#__codelineno-30-32"><span class="linenos" data-linenos="32 "></span></a>
</span><span id="__span-30-33"><a id="__codelineno-30-33" name="__codelineno-30-33"></a><a href="#__codelineno-30-33"><span class="linenos" data-linenos="33 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Build and push Docker image</span>
</span><span id="__span-30-34"><a id="__codelineno-30-34" name="__codelineno-30-34"></a><a href="#__codelineno-30-34"><span class="linenos" data-linenos="34 "></span></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docker/build-push-action@v5</span>
</span><span id="__span-30-35"><a id="__codelineno-30-35" name="__codelineno-30-35"></a><a href="#__codelineno-30-35"><span class="linenos" data-linenos="35 "></span></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
</span><span id="__span-30-36"><a id="__codelineno-30-36" name="__codelineno-30-36"></a><a href="#__codelineno-30-36"><span class="linenos" data-linenos="36 "></span></a><span class="w">          </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./pj1</span>
</span><span id="__span-30-37"><a id="__codelineno-30-37" name="__codelineno-30-37"></a><a href="#__codelineno-30-37"><span class="linenos" data-linenos="37 "></span></a><span class="w">          </span><span class="nt">push</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-30-38"><a id="__codelineno-30-38" name="__codelineno-30-38"></a><a href="#__codelineno-30-38"><span class="linenos" data-linenos="38 "></span></a><span class="w">          </span><span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-30-39"><a id="__codelineno-30-39" name="__codelineno-30-39"></a><a href="#__codelineno-30-39"><span class="linenos" data-linenos="39 "></span></a><span class="w">            </span><span class="no">zzdnb/docker_django_demo:${{ github.sha }}</span>
</span><span id="__span-30-40"><a id="__codelineno-30-40" name="__codelineno-30-40"></a><a href="#__codelineno-30-40"><span class="linenos" data-linenos="40 "></span></a><span class="w">            </span><span class="no">zzdnb/docker_django_demo:latest</span>
</span><span id="__span-30-41"><a id="__codelineno-30-41" name="__codelineno-30-41"></a><a href="#__codelineno-30-41"><span class="linenos" data-linenos="41 "></span></a><span class="w">            </span><span class="no">ghcr.io/zhenda-hub/docker_django_demo:${{ github.sha }}</span>
</span><span id="__span-30-42"><a id="__codelineno-30-42" name="__codelineno-30-42"></a><a href="#__codelineno-30-42"><span class="linenos" data-linenos="42 "></span></a><span class="w">            </span><span class="no">ghcr.io/zhenda-hub/docker_django_demo:latest</span>
</span><span id="__span-30-43"><a id="__codelineno-30-43" name="__codelineno-30-43"></a><a href="#__codelineno-30-43"><span class="linenos" data-linenos="43 "></span></a>
</span><span id="__span-30-44"><a id="__codelineno-30-44" name="__codelineno-30-44"></a><a href="#__codelineno-30-44"><span class="linenos" data-linenos="44 "></span></a><span class="w">  </span><span class="nt">deploy</span><span class="p">:</span>
</span><span id="__span-30-45"><a id="__codelineno-30-45" name="__codelineno-30-45"></a><a href="#__codelineno-30-45"><span class="linenos" data-linenos="45 "></span></a><span class="w">    </span><span class="nt">needs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">build</span>
</span><span id="__span-30-46"><a id="__codelineno-30-46" name="__codelineno-30-46"></a><a href="#__codelineno-30-46"><span class="linenos" data-linenos="46 "></span></a><span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>
</span><span id="__span-30-47"><a id="__codelineno-30-47" name="__codelineno-30-47"></a><a href="#__codelineno-30-47"><span class="linenos" data-linenos="47 "></span></a>
</span><span id="__span-30-48"><a id="__codelineno-30-48" name="__codelineno-30-48"></a><a href="#__codelineno-30-48"><span class="linenos" data-linenos="48 "></span></a><span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
</span><span id="__span-30-49"><a id="__codelineno-30-49" name="__codelineno-30-49"></a><a href="#__codelineno-30-49"><span class="linenos" data-linenos="49 "></span></a>
</span><span id="__span-30-50"><a id="__codelineno-30-50" name="__codelineno-30-50"></a><a href="#__codelineno-30-50"><span class="linenos" data-linenos="50 "></span></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deploy to Tencent Cloud</span>
</span><span id="__span-30-51"><a id="__codelineno-30-51" name="__codelineno-30-51"></a><a href="#__codelineno-30-51"><span class="linenos" data-linenos="51 "></span></a><span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appleboy/ssh-action@master</span>
</span><span id="__span-30-52"><a id="__codelineno-30-52" name="__codelineno-30-52"></a><a href="#__codelineno-30-52"><span class="linenos" data-linenos="52 "></span></a><span class="w">        </span><span class="nt">with</span><span class="p">:</span>
</span><span id="__span-30-53"><a id="__codelineno-30-53" name="__codelineno-30-53"></a><a href="#__codelineno-30-53"><span class="linenos" data-linenos="53 "></span></a><span class="w">          </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.TENCENT_HOST }}</span>
</span><span id="__span-30-54"><a id="__codelineno-30-54" name="__codelineno-30-54"></a><a href="#__codelineno-30-54"><span class="linenos" data-linenos="54 "></span></a><span class="w">          </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.TENCENT_USERNAME }}</span>
</span><span id="__span-30-55"><a id="__codelineno-30-55" name="__codelineno-30-55"></a><a href="#__codelineno-30-55"><span class="linenos" data-linenos="55 "></span></a><span class="w">          </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.TENCENT_PRI_SSH_KEY }}</span>
</span><span id="__span-30-56"><a id="__codelineno-30-56" name="__codelineno-30-56"></a><a href="#__codelineno-30-56"><span class="linenos" data-linenos="56 "></span></a><span class="w">          </span><span class="c1"># password: ${{ secrets.TENCENT_PASSWORD }}</span>
</span><span id="__span-30-57"><a id="__codelineno-30-57" name="__codelineno-30-57"></a><a href="#__codelineno-30-57"><span class="linenos" data-linenos="57 "></span></a><span class="w">          </span><span class="nt">script</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-30-58"><a id="__codelineno-30-58" name="__codelineno-30-58"></a><a href="#__codelineno-30-58"><span class="linenos" data-linenos="58 "></span></a><span class="w">            </span><span class="no">cd /www/wwwroot/docker-django-demo</span>
</span><span id="__span-30-59"><a id="__codelineno-30-59" name="__codelineno-30-59"></a><a href="#__codelineno-30-59"><span class="linenos" data-linenos="59 "></span></a><span class="w">            </span><span class="no">git pull</span>
</span><span id="__span-30-60"><a id="__codelineno-30-60" name="__codelineno-30-60"></a><a href="#__codelineno-30-60"><span class="linenos" data-linenos="60 "></span></a><span class="w">            </span><span class="no">sudo docker compose up --build -d</span>
</span></code></pre></div></p>
<ol>
<li>服务器中设置ssh
   <div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><a href="#__codelineno-31-1"><span class="linenos" data-linenos="1 "></span></a>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a><a href="#__codelineno-31-2"><span class="linenos" data-linenos="2 "></span></a>cat<span class="w"> </span>~/.ssh/id_rsa.pub<span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.ssh/authorized_keys
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a><a href="#__codelineno-31-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># 最后在secret中设置私钥</span>
</span></code></pre></div></li>
<li>在github的代码仓库中, 设置很多的secret</li>
</ol>
<h2 id="_20">其余内容<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h2>
<h3 id="buildx">Buildx<a class="headerlink" href="#buildx" title="Permanent link">&para;</a></h3>
<p>Buildx 是 Docker 的一个 CLI 插件，扩展了 docker build 命令的功能。它支持多平台构建、构建缓存、并行构建等高级功能</p>
<h3 id="docker-swarm">Docker Swarm<a class="headerlink" href="#docker-swarm" title="Permanent link">&para;</a></h3>
<p>要将应用部署到多个节点（服务器），实现分布式部署</p>
<p>通常需要多个服务器!!! 才可以体现出其高可用性和扩展性</p>
<h3 id="docker-desktop">关于 Docker Desktop 的使用<a class="headerlink" href="#docker-desktop" title="Permanent link">&para;</a></h3>
<h4 id="windows-wsl2">使用 windows WSL2<a class="headerlink" href="#windows-wsl2" title="Permanent link">&para;</a></h4>
<p><a href="https://learn.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig">https://learn.microsoft.com/en-us/windows/wsl/wsl-config#configure-global-options-with-wslconfig</a></p>
<p>配置WSL防止内存过大</p>
<ol>
<li>创建 C:\Users\username.wslconfig</li>
<li>
<p>写入以下内容</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><a href="#__codelineno-32-1"><span class="linenos" data-linenos=" 1 "></span></a>[wsl2]
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a><a href="#__codelineno-32-2"><span class="linenos" data-linenos=" 2 "></span></a># 配置 WSL 的核心数
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a><a href="#__codelineno-32-3"><span class="linenos" data-linenos=" 3 "></span></a>processors=2
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a><a href="#__codelineno-32-4"><span class="linenos" data-linenos=" 4 "></span></a># 配置 WSL 的内存最大值
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a><a href="#__codelineno-32-5"><span class="linenos" data-linenos=" 5 "></span></a>memory=2GB
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a><a href="#__codelineno-32-6"><span class="linenos" data-linenos=" 6 "></span></a># 配置交换内存大小，默认是电脑内存的 1/4
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7"></a><a href="#__codelineno-32-7"><span class="linenos" data-linenos=" 7 "></span></a>swap=8GB
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8"></a><a href="#__codelineno-32-8"><span class="linenos" data-linenos=" 8 "></span></a># 关闭默认连接以将 WSL 2 本地主机绑定到 Windows 本地主机
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9"></a><a href="#__codelineno-32-9"><span class="linenos" data-linenos=" 9 "></span></a>localhostForwarding=true
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10"></a><a href="#__codelineno-32-10"><span class="linenos" data-linenos="10 "></span></a># 设置临时文件位置，默认 %USERPROFILE%\\AppData\\Local\\Temp\\swap.vhdx
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11"></a><a href="#__codelineno-32-11"><span class="linenos" data-linenos="11 "></span></a># swapfile=D:\\\\temp\\\\wsl-swap.vhdx
</span></code></pre></div>
</li>
</ol>
<h4 id="docker-engine">docker engine 配置<a class="headerlink" href="#docker-engine" title="Permanent link">&para;</a></h4>
<p>~/.docker/daemon.json</p>
<div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><a href="#__codelineno-33-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a><a href="#__codelineno-33-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">  </span><span class="nt">&quot;builder&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a><a href="#__codelineno-33-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">    </span><span class="nt">&quot;gc&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a><a href="#__codelineno-33-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">      </span><span class="nt">&quot;defaultKeepStorage&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;20GB&quot;</span><span class="p">,</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5"></a><a href="#__codelineno-33-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">      </span><span class="nt">&quot;enabled&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6"></a><a href="#__codelineno-33-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7"></a><a href="#__codelineno-33-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8"></a><a href="#__codelineno-33-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">  </span><span class="nt">&quot;experimental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9"></a><a href="#__codelineno-33-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">  </span><span class="nt">&quot;log-driver&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;json-file&quot;</span><span class="p">,</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10"></a><a href="#__codelineno-33-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">  </span><span class="nt">&quot;log-opts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11"></a><a href="#__codelineno-33-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="nt">&quot;max-size&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;10m&quot;</span><span class="p">,</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12"></a><a href="#__codelineno-33-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="nt">&quot;max-file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;3&quot;</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13"></a><a href="#__codelineno-33-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14"></a><a href="#__codelineno-33-14"><span class="linenos" data-linenos="14 "></span></a><span class="p">}</span>
</span></code></pre></div>
<h4 id="disk-is-full">报错 disk is full<a class="headerlink" href="#disk-is-full" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><a href="#__codelineno-34-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># 查看占用情况</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a><a href="#__codelineno-34-2"><span class="linenos" data-linenos="2 "></span></a>docker<span class="w"> </span>system<span class="w"> </span>df
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a><a href="#__codelineno-34-3"><span class="linenos" data-linenos="3 "></span></a><span class="c1"># 清除所有</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a><a href="#__codelineno-34-4"><span class="linenos" data-linenos="4 "></span></a>docker<span class="w"> </span>system<span class="w"> </span>prune<span class="w"> </span>-a<span class="w"> </span>--volumes<span class="w"> </span>-f
</span></code></pre></div>
<p>设置 Virtual disk limit</p>
<h3 id="_21">更换安装位置到别的盘<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<p><a href="https://stackoverflow.com/questions/40465979/change-docker-native-images-location-on-windows-10-pro">https://stackoverflow.com/questions/40465979/change-docker-native-images-location-on-windows-10-pro</a></p>
<h3 id="_22">换源<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<h4 id="apt">apt换国内源<a class="headerlink" href="#apt" title="Permanent link">&para;</a></h4>
<div class="language-Dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><a href="#__codelineno-35-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c"># debian12 替换 APT 源为国内源</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a><a href="#__codelineno-35-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="k">RUN</span><span class="w"> </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s@deb.debian.org@mirrors.tuna.tsinghua.edu.cn@g&#39;</span><span class="w"> </span>/etc/apt/sources.list.d/debian.sources<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><a href="#__codelineno-35-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">    </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s@deb.debian.org@mirrors.ustc.edu.cn@g&#39;</span><span class="w"> </span>/etc/apt/sources.list.d/debian.sources<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a><a href="#__codelineno-35-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">    </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s@deb.debian.org@mirrors.aliyun.com@g&#39;</span><span class="w"> </span>/etc/apt/sources.list.d/debian.sources<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5"></a><a href="#__codelineno-35-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">    </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;s@deb.debian.org@mirrors.cloud.tencent.com@g&#39;</span><span class="w"> </span>/etc/apt/sources.list.d/debian.sources
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6"></a><a href="#__codelineno-35-6"><span class="linenos" data-linenos=" 6 "></span></a>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7"></a><a href="#__codelineno-35-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="c"># 更新, 安装所需的软件包（这里仅为示例）, 最后清理apt-get缓存</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8"></a><a href="#__codelineno-35-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9"></a><a href="#__codelineno-35-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">    </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--no-install-recommends<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10"></a><a href="#__codelineno-35-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11"></a><a href="#__codelineno-35-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span>git<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12"></a><a href="#__codelineno-35-12"><span class="linenos" data-linenos="12 "></span></a><span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13"></a><a href="#__codelineno-35-13"><span class="linenos" data-linenos="13 "></span></a><span class="w">    </span>apt-get<span class="w"> </span>clean<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*
</span></code></pre></div>
<h4 id="pip">pip换国内源<a class="headerlink" href="#pip" title="Permanent link">&para;</a></h4>
<div class="language-Dockerfile highlight"><span class="filename">Docker</span><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><a href="#__codelineno-36-1"><span class="linenos" data-linenos="1 "></span></a><span class="c"># 设置 pip 源为阿里云源和其他国内源</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a><a href="#__codelineno-36-2"><span class="linenos" data-linenos="2 "></span></a><span class="k">RUN</span><span class="w"> </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.index-url<span class="w"> </span>https://pypi.tuna.tsinghua.edu.cn/simple/<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a><a href="#__codelineno-36-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">    </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.extra-index-url<span class="w"> </span>https://mirrors.aliyun.com/pypi/simple/<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4"></a><a href="#__codelineno-36-4"><span class="linenos" data-linenos="4 "></span></a><span class="w">    </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>global.extra-index-url<span class="w"> </span>https://mirrors.cloud.tencent.com/pypi/simple/<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5"></a><a href="#__codelineno-36-5"><span class="linenos" data-linenos="5 "></span></a><span class="w">    </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>install.trusted-host<span class="w"> </span>pypi.tuna.tsinghua.edu.cn<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6"></a><a href="#__codelineno-36-6"><span class="linenos" data-linenos="6 "></span></a><span class="w">    </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>install.trusted-host<span class="w"> </span>mirrors.aliyun.com<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7"></a><a href="#__codelineno-36-7"><span class="linenos" data-linenos="7 "></span></a><span class="w">    </span>pip<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>install.trusted-host<span class="w"> </span>mirrors.cloud.tencent.com
</span></code></pre></div>
<h4 id="docker_4">docker换国内源<a class="headerlink" href="#docker_4" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><a href="#__codelineno-37-1"><span class="linenos" data-linenos="1 "></span></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/docker/daemon.json
</span></code></pre></div>
<div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><a href="#__codelineno-38-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="p">{</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a><a href="#__codelineno-38-2"><span class="linenos" data-linenos=" 2 "></span></a><span class="w">    </span><span class="nt">&quot;registry-mirrors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a><a href="#__codelineno-38-3"><span class="linenos" data-linenos=" 3 "></span></a><span class="w">        </span><span class="s2">&quot;https://docker.m.daocloud.io&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a><a href="#__codelineno-38-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="w">        </span><span class="s2">&quot;https://noohub.ru&quot;</span><span class="p">,</span><span class="w"> </span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5"></a><a href="#__codelineno-38-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="w">        </span><span class="s2">&quot;https://huecker.io&quot;</span><span class="p">,</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6"></a><a href="#__codelineno-38-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="w">        </span><span class="s2">&quot;https://dockerhub.timeweb.cloud&quot;</span><span class="p">,</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7"></a><a href="#__codelineno-38-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="w">        </span><span class="s2">&quot;https://mirror.ccs.tencentyun.com&quot;</span><span class="p">,</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8"></a><a href="#__codelineno-38-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="w">        </span><span class="s2">&quot;https://registry.docker-cn.com&quot;</span><span class="p">,</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9"></a><a href="#__codelineno-38-9"><span class="linenos" data-linenos=" 9 "></span></a><span class="w">        </span><span class="s2">&quot;http://docker.mirrors.ustc.edu.cn&quot;</span><span class="p">,</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10"></a><a href="#__codelineno-38-10"><span class="linenos" data-linenos="10 "></span></a><span class="w">        </span><span class="s2">&quot;http://hub-mirror.c.163.com&quot;</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11"></a><a href="#__codelineno-38-11"><span class="linenos" data-linenos="11 "></span></a><span class="w">    </span><span class="p">]</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12"></a><a href="#__codelineno-38-12"><span class="linenos" data-linenos="12 "></span></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="image_1">Image测试平台<a class="headerlink" href="#image_1" title="Permanent link">&para;</a></h3>
<p><a href="https://labs.play-with-docker.com/">https://labs.play-with-docker.com/</a></p>
<p>可以在这个平台, 测试镜像是否符合预期</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../django%E6%95%99%E7%A8%8B/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Django教程">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Django教程
              </div>
            </div>
          </a>
        
        
          
          <a href="../emoji-support/" class="md-footer__link md-footer__link--next" aria-label="Next: Emoji support">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Emoji support
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 zhenda
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.expand", "navigation.path", "navigation.top", "navigation.tracking", "navigation.footer", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>