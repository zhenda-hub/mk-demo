
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../css-guide/">
      
      
        <link rel="next" href="../../f2/AI%E6%95%99%E7%A8%8B/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Databases - MkLorum</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MkLorum" class="md-header__button md-logo" aria-label="MkLorum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MkLorum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Databases
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label=""  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label=""  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label=""  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple"  aria-label=""  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="" for="__palette_4" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="cyan"  aria-label=""  type="radio" name="__palette" id="__palette_4">
    
      <label class="md-header__button md-icon" title="" for="__palette_5" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="grey" data-md-color-accent="cyan"  aria-label=""  type="radio" name="__palette" id="__palette_5">
    
      <label class="md-header__button md-icon" title="" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MkLorum" class="md-nav__button md-logo" aria-label="MkLorum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MkLorum
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HOME
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ABOUT
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    📋 Material for MkDocs 提示框完整指南
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Posts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Posts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/app-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    App design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/browser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Browser
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/cloud-servers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cloud servers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/posts/computer-science-crash-course/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Computer science crash course
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F1
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            F1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Decentralization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Decentralization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../algorithm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Algorithm
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../crawler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Crawler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../css-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Css guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Databases
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Databases
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      设计表
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foreignkey" class="md-nav__link">
    <span class="md-ellipsis">
      外键 ForeignKey
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      事务
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      索引
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      数据库连接池
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      本地连接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      代码连接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navicat-dbeaver" class="md-nav__link">
    <span class="md-ellipsis">
      远程连接(navicat, dbeaver)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="远程连接(navicat, dbeaver)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-mysql" class="md-nav__link">
    <span class="md-ellipsis">
      连接mysql的设置, mysql很麻烦
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      分布式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分布式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      数据同步
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F2
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            F2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f2/AI%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AI教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f2/django%E6%95%99%E7%A8%8B/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Django教程
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f2/docker%E6%8C%87%E5%8D%97/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker指南
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f2/emoji-support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emoji support
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    F3
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            F3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/english-stu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    English stu
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/evangelism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evangelism
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/excel-note/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Excel note
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../f3/fastapi-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fastapi tutorial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      设计表
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foreignkey" class="md-nav__link">
    <span class="md-ellipsis">
      外键 ForeignKey
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      事务
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      索引
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      数据库连接池
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      本地连接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      代码连接
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navicat-dbeaver" class="md-nav__link">
    <span class="md-ellipsis">
      远程连接(navicat, dbeaver)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="远程连接(navicat, dbeaver)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mysql-mysql" class="md-nav__link">
    <span class="md-ellipsis">
      连接mysql的设置, mysql很麻烦
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      分布式
    </span>
  </a>
  
    <nav class="md-nav" aria-label="分布式">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      数据同步
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Databases</h1>

<p>+++
title = 'Databases'
subtitle = ""
date = 2024-06-03T09:21:49+08:00
draft = true
toc = true
tags = ['tools']
+++</p>
<p>mysql 优化: <a href="https://dev.to/hamzakhan/how-youtube-scaled-mysql-to-support-249-billion-users-3eea">https://dev.to/hamzakhan/how-youtube-scaled-mysql-to-support-249-billion-users-3eea</a></p>
<h2 id="_1">设计表<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>可以通过界面来分析字段</p>
<!-- 命名

小写字母下划线

| 类型 | 命名 |
|---|---|
| 主键索引名 | pk_字段名 |
| 唯一索引名 | uk_字段名 |
| 普通索引名 | idx_字段名 | -->

<p>一个表代表一个类, <code>是一个名词, 而不是动词</code></p>
<ul>
<li>为了简单方便, 可以将数据量少的设计为一个表</li>
<li>将字段很多的表分为多个表</li>
<li>将数据量过万的表分为多个表</li>
</ul>
<p>推荐字段</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>命名</th>
</tr>
</thead>
<tbody>
<tr>
<td>主键</td>
<td>id</td>
</tr>
<tr>
<td>创建时间</td>
<td>create_time</td>
</tr>
<tr>
<td>更新时间</td>
<td>update_time</td>
</tr>
<tr>
<td>软删除</td>
<td>is_deleted</td>
</tr>
</tbody>
</table>
<h2 id="foreignkey">外键 ForeignKey<a class="headerlink" href="#foreignkey" title="Permanent link">&para;</a></h2>
<p>数据关系如下:</p>
<div class="language-json highlight"><span class="filename">JSON</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a><a href="#__codelineno-0-1"><span class="linenos" data-linenos="1 "></span></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><a href="#__codelineno-0-2"><span class="linenos" data-linenos="2 "></span></a><span class="w">    </span><span class="err">&#39;a</span><span class="mi">1</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;b1&quot;</span><span class="p">,</span><span class="s2">&quot;b2&quot;</span><span class="p">,</span><span class="s2">&quot;b3&quot;</span><span class="p">],</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a><a href="#__codelineno-0-3"><span class="linenos" data-linenos="3 "></span></a><span class="w">    </span><span class="err">&#39;a</span><span class="mi">2</span><span class="err">&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;b4&quot;</span><span class="p">,</span><span class="s2">&quot;b5&quot;</span><span class="p">]</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a><a href="#__codelineno-0-4"><span class="linenos" data-linenos="4 "></span></a><span class="p">}</span>
</span></code></pre></div>
<table>
<thead>
<tr>
<th>Author</th>
<th>Book</th>
</tr>
</thead>
<tbody>
<tr>
<td>a1</td>
<td>b1</td>
</tr>
<tr>
<td>a1</td>
<td>b2</td>
</tr>
<tr>
<td>a1</td>
<td>b3</td>
</tr>
<tr>
<td>a2</td>
<td>b4</td>
</tr>
<tr>
<td>a2</td>
<td>b5</td>
</tr>
</tbody>
</table>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><a href="#__codelineno-1-1"><span class="linenos" data-linenos="1 "></span></a><span class="c1"># 通过外键关联1</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><a href="#__codelineno-1-2"><span class="linenos" data-linenos="2 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">Author</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><a href="#__codelineno-1-3"><span class="linenos" data-linenos="3 "></span></a>    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><a href="#__codelineno-1-4"><span class="linenos" data-linenos="4 "></span></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><a href="#__codelineno-1-5"><span class="linenos" data-linenos="5 "></span></a><span class="k">class</span><span class="w"> </span><span class="nc">Book</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><a href="#__codelineno-1-6"><span class="linenos" data-linenos="6 "></span></a>    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a><a href="#__codelineno-1-7"><span class="linenos" data-linenos="7 "></span></a>    <span class="n">author</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Author</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>  <span class="c1"># author删除时, 所有的book也删除</span>
</span></code></pre></div>
<h2 id="_2">事务<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h2 id="_3">索引<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>查询优化是对经常查询的列设置索引, 主键, 外键 默认设置索引</p>
<h2 id="_4">数据库连接池<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h2 id="_5">本地连接<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><span class="filename">Bash</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><a href="#__codelineno-2-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="c1"># mysql</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a><a href="#__codelineno-2-2"><span class="linenos" data-linenos=" 2 "></span></a>mysql<span class="w"> </span>--version
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><a href="#__codelineno-2-3"><span class="linenos" data-linenos=" 3 "></span></a>mysql<span class="w"> </span>-u<span class="w"> </span>root<span class="w"> </span>-p<span class="w"> </span>-h<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>-P<span class="w"> </span><span class="m">3306</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><a href="#__codelineno-2-4"><span class="linenos" data-linenos=" 4 "></span></a>SHOW<span class="w"> </span>DATABASES<span class="p">;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><a href="#__codelineno-2-5"><span class="linenos" data-linenos=" 5 "></span></a>SHOW<span class="w"> </span>TABLES<span class="p">;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><a href="#__codelineno-2-6"><span class="linenos" data-linenos=" 6 "></span></a>EXIT<span class="p">;</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><a href="#__codelineno-2-7"><span class="linenos" data-linenos=" 7 "></span></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><a href="#__codelineno-2-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="c1"># pg</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a><a href="#__codelineno-2-9"><span class="linenos" data-linenos=" 9 "></span></a>psql<span class="w"> </span>--version
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><a href="#__codelineno-2-10"><span class="linenos" data-linenos="10 "></span></a>psql<span class="w"> </span>-U<span class="w"> </span>username<span class="w"> </span>-d<span class="w"> </span>database_name<span class="w"> </span>-h<span class="w"> </span>host<span class="w"> </span>-p<span class="w"> </span>port
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><a href="#__codelineno-2-11"><span class="linenos" data-linenos="11 "></span></a>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><a href="#__codelineno-2-12"><span class="linenos" data-linenos="12 "></span></a><span class="se">\?</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><a href="#__codelineno-2-13"><span class="linenos" data-linenos="13 "></span></a><span class="se">\l</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><a href="#__codelineno-2-14"><span class="linenos" data-linenos="14 "></span></a><span class="se">\c</span><span class="w"> </span>database_name
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a><a href="#__codelineno-2-15"><span class="linenos" data-linenos="15 "></span></a><span class="se">\d</span>t
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><a href="#__codelineno-2-16"><span class="linenos" data-linenos="16 "></span></a><span class="se">\d</span><span class="w"> </span>table_name
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><a href="#__codelineno-2-17"><span class="linenos" data-linenos="17 "></span></a><span class="se">\q</span>
</span></code></pre></div>
<h2 id="_6">代码连接<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<div class="language-python highlight"><span class="filename">Python</span><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><a href="#__codelineno-3-1"><span class="linenos" data-linenos=" 1 "></span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pymysql</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a><a href="#__codelineno-3-2"><span class="linenos" data-linenos=" 2 "></span></a>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a><a href="#__codelineno-3-3"><span class="linenos" data-linenos=" 3 "></span></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><a href="#__codelineno-3-4"><span class="linenos" data-linenos=" 4 "></span></a><span class="n">q</span> <span class="o">=</span> <span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">charset</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a><a href="#__codelineno-3-5"><span class="linenos" data-linenos=" 5 "></span></a><span class="n">p</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a><a href="#__codelineno-3-6"><span class="linenos" data-linenos=" 6 "></span></a><span class="c1"># 查</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a><a href="#__codelineno-3-7"><span class="linenos" data-linenos=" 7 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a><a href="#__codelineno-3-8"><span class="linenos" data-linenos=" 8 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a><a href="#__codelineno-3-9"><span class="linenos" data-linenos=" 9 "></span></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10"></a><a href="#__codelineno-3-10"><span class="linenos" data-linenos="10 "></span></a><span class="c1"># 增删改</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11"></a><a href="#__codelineno-3-11"><span class="linenos" data-linenos="11 "></span></a><span class="k">try</span><span class="p">:</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12"></a><a href="#__codelineno-3-12"><span class="linenos" data-linenos="12 "></span></a>    <span class="n">p</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13"></a><a href="#__codelineno-3-13"><span class="linenos" data-linenos="13 "></span></a>    <span class="n">q</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14"></a><a href="#__codelineno-3-14"><span class="linenos" data-linenos="14 "></span></a>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15"></a><a href="#__codelineno-3-15"><span class="linenos" data-linenos="15 "></span></a><span class="k">except</span><span class="p">:</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16"></a><a href="#__codelineno-3-16"><span class="linenos" data-linenos="16 "></span></a>    <span class="n">q</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17"></a><a href="#__codelineno-3-17"><span class="linenos" data-linenos="17 "></span></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18"></a><a href="#__codelineno-3-18"><span class="linenos" data-linenos="18 "></span></a>    <span class="o">...</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19"></a><a href="#__codelineno-3-19"><span class="linenos" data-linenos="19 "></span></a>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20"></a><a href="#__codelineno-3-20"><span class="linenos" data-linenos="20 "></span></a><span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21"></a><a href="#__codelineno-3-21"><span class="linenos" data-linenos="21 "></span></a><span class="n">q</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></div>
<h2 id="navicat-dbeaver">远程连接(navicat, dbeaver)<a class="headerlink" href="#navicat-dbeaver" title="Permanent link">&para;</a></h2>
<h3 id="mysql-mysql">连接mysql的设置, mysql很麻烦<a class="headerlink" href="#mysql-mysql" title="Permanent link">&para;</a></h3>
<p>navicat 连接 容器 MySQL 报错 </p>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> --default-authentication-plugin=mysql_native_password</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> --default-authentication-plugin=caching_sha2_password</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> --default-authentication-plugin=sha256_password</li>
</ul>
<p>在 "Driver Properties" 或 "连接属性" 选项卡中添加以下参数：</p>
<ul>
<li>allowPublicKeyRetrieval=true</li>
<li>useSSL=false</li>
</ul>
<h2 id="_7">分布式<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="_8">数据同步<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>关系型</p>
<ul>
<li>
<p>mysql</p>
<ul>
<li>
<p>基础</p>
<ul>
<li>环境变量<ul>
<li>我的电脑<ul>
<li>高级设置<ul>
<li>path 里添加 mysql 安装路径</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>配置文件<ul>
<li>my.cnf</li>
</ul>
</li>
<li>图形控制软件<ul>
<li>Navicat<ul>
<li>步骤<ul>
<li>设置密码不过期<ul>
<li>alter user 'root'@'localhost' identified by 'root' password expire never;</li>
</ul>
</li>
<li>修改加密规则<ul>
<li>alter user 'root'@'localhost' identified with mysql_native_password by 'root';</li>
</ul>
</li>
<li>连接 mysql<ul>
<li>设置编码</li>
</ul>
</li>
<li>创建数据库</li>
<li>新建查询<ul>
<li>写 sql</li>
</ul>
</li>
</ul>
</li>
<li>可以选择代码来运行<ul>
<li>快捷键<ul>
<li>ctrl, shift, r</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>默认数据库<ul>
<li>mysql<ul>
<li>管理用户的表<ul>
<li>user</li>
</ul>
</li>
</ul>
</li>
<li>performance</li>
<li>sys</li>
<li>test<ul>
<li>每个用户一个测试用的数据库</li>
</ul>
</li>
</ul>
</li>
<li>查看字符集格式<ul>
<li>show variables like 'char%';</li>
</ul>
</li>
<li>最基本操作！！！！！<ul>
<li>命令行访问<ul>
<li>启动<ul>
<li>service mysql restart</li>
<li>service mysql start</li>
</ul>
</li>
<li>登录<ul>
<li>mysql -h localhost -u root -p;<ul>
<li>--port=</li>
<li>root</li>
</ul>
</li>
</ul>
</li>
<li>基本操作<ul>
<li>show databases;</li>
<li>use mysql;<ul>
<li>选择数据库</li>
</ul>
</li>
<li>show tables;</li>
<li>desc 表；</li>
<li>select database();<ul>
<li>查看当前数据库</li>
</ul>
</li>
<li>exit;</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>sql 语句</p>
<ul>
<li>
<p>分类</p>
<ul>
<li>
<p>权限管理</p>
<ul>
<li>
<p>DCL</p>
<ul>
<li>
<p>运维重点</p>
<ul>
<li>用户密码控制<ul>
<li>查看用户<ul>
<li>select user,host from mysql.user</li>
</ul>
</li>
<li>设置密码等级<ul>
<li>set global validate_password.policy=LOW</li>
<li>set global validate_password.length=1</li>
</ul>
</li>
<li>重新设置密码<ul>
<li>mysqladmin -uroot -p password</li>
</ul>
</li>
</ul>
</li>
<li>查看权限<ul>
<li>show grants for 用户@host</li>
</ul>
</li>
<li>
<p>远程连接设置</p>
<ul>
<li>概念<ul>
<li>一个 pc 连接另一个 pc 的 mysql</li>
</ul>
</li>
<li>
<p>主要步骤
    _ 创建用户
    _ 语法
    _ create user 用户@host identified by 密码
    _ 例子
    _ create user 'zzd'@'%' identified by 'root'
    _ 给与权限
    _ 语法
    _ grant 权限 on 表 to 用户@host
    _ 例子
    _ grant all on <em>.</em> to 'zzd'@'%'
    _ 删除用户
    _ drop user ‘用户’@‘ip’ * 例子</p>
<div class="language-text highlight"><span class="filename">Text Only</span><pre><span></span><code><span class="linenos" data-linenos="1 "></span>  * update user set host=&#39;%&#39; where user=&#39;root&#39;;
<span class="linenos" data-linenos="2 "></span>      * nat方式连接，查看虚拟ip
</code></pre></div>
<ul>
<li>刷新授权表，立即生效<ul>
<li>flush privileges;</li>
</ul>
</li>
</ul>
</li>
<li>
<p>其他相关操作</p>
<ul>
<li>管理员身份运行<ul>
<li>mysqld -install</li>
</ul>
</li>
<li>访问速度慢<ul>
<li>修改 my.ini<ul>
<li>在 mysqld 里面添加一句话<ul>
<li>skip-name-resolve</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>帮助信息</p>
<ul>
<li>? Account Management</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>数据库，表</p>
<ul>
<li>
<p>DDL</p>
<ul>
<li>database<ul>
<li>create database 库名称 (各个列的内容);</li>
<li>drop database 库名称</li>
<li>use 库名称<ul>
<li>选择库</li>
</ul>
</li>
</ul>
</li>
<li>
<p>table</p>
<ul>
<li>
<p>语句</p>
<ul>
<li>
<p>create table 表名称 (各个列的内容);</p>
<ul>
<li>primary key<ul>
<li>中文：主键，非常关键<ul>
<li>唯一且非空</li>
</ul>
</li>
</ul>
</li>
<li>auto_increment<ul>
<li>用于整数</li>
</ul>
</li>
</ul>
</li>
<li>
<p>alter table 表名称</p>
<ul>
<li>ADD<ul>
<li>name char(1)</li>
</ul>
</li>
<li>DROP<ul>
<li>MODIFY<ul>
<li>内容</li>
</ul>
</li>
<li>change oldname, name<ul>
<li>内容和列名</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>drop table 表名称</li>
</ul>
</li>
<li>
<p>约束</p>
<ul>
<li>概念<ul>
<li>对于表中的各个列内容的限制</li>
</ul>
</li>
<li>
<p>分类</p>
<ul>
<li>非外键<ul>
<li>字段后面<ul>
<li>primary key<ul>
<li>中文：主键，非常关键</li>
<li>唯一且非空</li>
</ul>
</li>
<li>auto_increment * 用于整数</li>
<li>UNIQUE</li>
<li>NOT NULL</li>
<li>DEFAULT</li>
<li>CHACK( sex='boy' || sex='girl')<ul>
<li>选择约束</li>
</ul>
</li>
</ul>
</li>
<li>表<ul>
<li>constraint 匿名 PRIMARY KRY(字段)<ul>
<li>唯一且非空</li>
</ul>
</li>
<li>constraint 匿名 CHACK( sex='boy'||sex='girl')</li>
<li>constraint 匿名 UNIQUE(字段)</li>
</ul>
</li>
<li>表外部添加<ul>
<li>alter table 表名称 add<ul>
<li>constraint 匿名 PRIMARY KRY（）</li>
</ul>
</li>
<li>alter table 表名称 modify<ul>
<li>auto_increment</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>外键</p>
<ul>
<li>概念<ul>
<li>子表通过外键，关联父表主键</li>
<li>相当于：类通过组合使用其他类</li>
</ul>
</li>
<li>使用<ul>
<li>子表重写<ul>
<li>表类型的<ul>
<li>constraint 匿名 foreign key (子表字段) references 父表名 (父表字段)</li>
<li>外部添加<ul>
<li>alter table 表名称 add<ul>
<li>constraint 匿名 foreign key (子表字段) references 父表名 (父表字段)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>删除</p>
<ul>
<li>
<p>外键策略</p>
<ul>
<li>目的<ul>
<li>方便修改或删除父表</li>
</ul>
</li>
<li>重新设置策略<ul>
<li>删除原来的外键约束<ul>
<li>alter table 表名称 drop foreign key 外键匿名</li>
</ul>
</li>
<li>外部添加<ul>
<li>on update cascsde on delete cascade<ul>
<li>会直接删除子表内容<ul>
<li>方便，但危险</li>
</ul>
</li>
</ul>
</li>
<li>on update set null on delete set null</li>
</ul>
</li>
</ul>
</li>
<li>分类</li>
</ul>
</li>
<li>
<p>一般情况</p>
<ul>
<li>先删除子表，再删除父表</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>表的字段</p>
<ul>
<li>添加<ul>
<li>alter table 表名 add 字段 A 类型 after 字段 B<ul>
<li>添加字段 A，放在字段 B 后面</li>
</ul>
</li>
</ul>
</li>
<li>删除<ul>
<li>alter table 表名 drop 字段</li>
</ul>
</li>
<li>修改<ul>
<li>alter table 表名 change 旧字段 新字段 新类型<ul>
<li>改字段名，改类型</li>
</ul>
</li>
<li>alter table 表名 modify 字段 新类型<ul>
<li>改字段的类型</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>表的索引<ul>
<li>添加<ul>
<li>alter table 表名 add index 索引名（字段）</li>
</ul>
</li>
<li>删除<ul>
<li>alter table 表名 drop index 索引名 （字段）</li>
</ul>
</li>
</ul>
</li>
<li>查看建表语句<ul>
<li>show create table 表名字</li>
</ul>
</li>
<li>修改表名<ul>
<li>rename table A to B</li>
<li>alter table A rename to B</li>
</ul>
</li>
</ul>
</li>
<li>
<p>view</p>
<ul>
<li>with check option<ul>
<li>控制选择条件</li>
</ul>
</li>
</ul>
</li>
<li>procedure<ul>
<li>存储过程 相当于函数<ul>
<li>创建<ul>
<li>（in ， out）<ul>
<li>begin<ul>
<li>if<ul>
<li>then</li>
</ul>
</li>
<li>else</li>
<li>end if;</li>
</ul>
</li>
<li>select found_rows() into<ul>
<li>返回查询个数</li>
</ul>
</li>
<li>end;</li>
</ul>
</li>
</ul>
</li>
<li>调用<ul>
<li>函数名（'', @rst）</li>
<li>select @rst;<ul>
<li>打印查询个数</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>帮助信息<ul>
<li>? Data Definition</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>数据</p>
<ul>
<li>DML！！！！<ul>
<li>添加一行数据<ul>
<li>insert into 表名称（字段 1，字段 2） values ('A','B')</li>
<li>insert into 表名称 values ('A','B')</li>
</ul>
</li>
<li>删<ul>
<li>删一行数据<ul>
<li>delete from 表名称 where</li>
</ul>
</li>
<li>清空表的数据<ul>
<li>truncate table 表名称<ul>
<li>重新建表</li>
<li>自增的主键不会保留</li>
</ul>
</li>
<li>delete from 表名称<ul>
<li>自增的主键会保留</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>改<ul>
<li>update 表名称 set 字段 1=‘’， 字段 2=‘’ where 条件</li>
</ul>
</li>
<li>帮助信息<ul>
<li>? Data Manipulation</li>
</ul>
</li>
<li>数据类型<ul>
<li>字符<ul>
<li>VARCHAR<ul>
<li>一句话</li>
</ul>
</li>
<li>TEXT<ul>
<li>大文章</li>
</ul>
</li>
</ul>
</li>
<li>数字<ul>
<li>INT</li>
<li>FLOAT</li>
<li>DOUBLE</li>
</ul>
</li>
<li>时间<ul>
<li>DATE</li>
<li>TIMESTAMP</li>
<li>time</li>
<li>DATETIME</li>
<li>NOW()</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>DQL<ul>
<li>select<ul>
<li>函数<ul>
<li>单行函数<ul>
<li>lower()</li>
<li>upper()</li>
<li>length（）</li>
<li>substring（字段， start， stop）<ul>
<li>下标从 1 开始</li>
</ul>
</li>
<li>abs（）</li>
<li>ceil()</li>
<li>floor()</li>
<li>round()</li>
<li>curdate()</li>
<li>curtime()</li>
<li>now()</li>
<li>sysdate()<ul>
<li>实际执行时间</li>
</ul>
</li>
<li>条件分支<ul>
<li>if(条件，A，B)</li>
<li>ifnull(条件，执行)</li>
<li>nullif(val1, val2)<ul>
<li>val1 等于 val2，则返回 null，否则返回 val1</li>
</ul>
</li>
<li>case</li>
<li>database()</li>
<li>user()</li>
<li>version()</li>
</ul>
</li>
</ul>
</li>
<li>多行函数<ul>
<li>概念<ul>
<li>对多个数据处理，返回一个结果</li>
</ul>
</li>
<li>特点<ul>
<li>自动忽略 null 的值</li>
<li>min（字段）</li>
<li>max（字段）</li>
<li>avg（字段）</li>
<li>sum()</li>
<li>count（字段）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>显示数据总数<ul>
<li>select count(*) from 表名</li>
</ul>
</li>
<li>显示数据<ul>
<li>SELECT * FROM 表名</li>
<li>SELECT * FROM 表名 \G</li>
</ul>
</li>
<li>单表查询<ul>
<li>单表操作<ul>
<li>去重<ul>
<li>distinct</li>
</ul>
</li>
</ul>
</li>
<li>执行顺序，从上往下<ul>
<li>from</li>
<li>分组前筛选<ul>
<li>where<ul>
<li>条件 A and 条件 B<ul>
<li>or</li>
<li>in（12，23）</li>
</ul>
</li>
<li>like ’‘<ul>
<li>’%A%‘<ul>
<li>%多个字符</li>
</ul>
</li>
<li>’_A%‘<ul>
<li>_代表一个字符</li>
</ul>
</li>
</ul>
</li>
<li>is null</li>
</ul>
</li>
</ul>
</li>
<li>按照字段的不同内容分组<ul>
<li>group by</li>
</ul>
</li>
<li>选择字段展示<ul>
<li>select</li>
</ul>
</li>
<li>having<ul>
<li>分组后筛选</li>
</ul>
</li>
<li>排序<ul>
<li>order by 字段<ul>
<li>asc<ul>
<li>升序</li>
</ul>
</li>
<li>desc<ul>
<li>降序</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>多表查询<ul>
<li>连接方式<ul>
<li>只显示匹配的表信息，不匹配的信息忽略<ul>
<li>交叉连接<ul>
<li>select * from 表 A cross join 表 B<ul>
<li>很多重复内容</li>
</ul>
</li>
</ul>
</li>
<li>自然连接<ul>
<li>select * from 表 A natural join 表 B<ul>
<li>匹配 所有同名列<ul>
<li>同名列只展示一次</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>内连接<ul>
<li>select * from 表 A inner join 表 B<ul>
<li>using 同名列字段<ul>
<li>选择 同名列</li>
</ul>
</li>
<li>on A.字段=B.字段<ul>
<li>设置 同名列<ul>
<li>设置 A 的字段，匹配 B 的字段<ul>
<li>自连接</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>on A.字段 betwen B.小字段 and B.大字段</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>显示匹配和不匹配的表信息<ul>
<li>左外连接<ul>
<li>select * from 表 A left outer join 表 B<ul>
<li>展示左表的全部信息</li>
</ul>
</li>
</ul>
</li>
<li>右外连接<ul>
<li>select * from 表 A right outer join 表 B<ul>
<li>展示右表的全部信息</li>
</ul>
</li>
</ul>
</li>
<li>合并左外连接，右外连接<ul>
<li>添加 union<ul>
<li>select _ from 表 A left outer join 表 B union select _ from 表 A right outer join 表 B</li>
</ul>
</li>
<li>select * from 表 A full outer join 表 B<ul>
<li>展示左外连接和右外连接合并的全部信息，但 mysql 不支持这个语法</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>分类<ul>
<li>两表查询</li>
<li>三表查询<ul>
<li>可以看成两表查询</li>
</ul>
</li>
<li>自己查询<ul>
<li>可以看成两表查询</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>子查询<ul>
<li>概念<ul>
<li>多个 sql 语句合并成，提高查询效率，总的 sql 语句依赖子的 sql 语句，子 sql 语句称为子查询</li>
</ul>
</li>
<li>select where （）<ul>
<li>不相关子查询<ul>
<li>概念<ul>
<li>可以独立运行的子查询</li>
</ul>
</li>
<li>分类<ul>
<li>单行<ul>
<li>查询结果为一个<ul>
<li>=</li>
<li>
<blockquote></blockquote>
</li>
<li>&lt;</li>
</ul>
</li>
</ul>
</li>
<li>多行<ul>
<li>查询结果多一个<ul>
<li>all（）</li>
<li>any（）</li>
<li>in（）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>相关子查询<ul>
<li>起一个别名</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>默认不区分大小写</p>
<ul>
<li>可以设置区分<ul>
<li>binary</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>事务</p>
<ul>
<li>需求背景<ul>
<li>银行转账，两个账户需要确保都完成，或都不完成</li>
</ul>
</li>
<li>特性<ul>
<li>ACID<ul>
<li>原子性</li>
<li>一致性</li>
<li>隔离性</li>
<li>持久性</li>
</ul>
</li>
</ul>
</li>
<li>原理<ul>
<li>默认一条 sql 语句，为一个事务</li>
<li>可以手动开启事务，执行多条 sql 语句</li>
</ul>
</li>
<li>流程<ul>
<li>start transaction<ul>
<li>手动开始一个事务</li>
</ul>
</li>
<li>多条 sql 语句<ul>
<li>操作缓存，不操作数据库</li>
</ul>
</li>
<li>可以选择<ul>
<li>rollback<ul>
<li>撤销</li>
</ul>
</li>
<li>commit<ul>
<li>提交</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>事务并发<ul>
<li>多个事务同时进行，同时操作缓存<ul>
<li>问题<ul>
<li>脏读<ul>
<li>数据错了</li>
</ul>
</li>
<li>不可重复读<ul>
<li>数据变了</li>
</ul>
</li>
<li>幻读<ul>
<li>数据多了</li>
</ul>
</li>
</ul>
</li>
<li>解决方法<ul>
<li>事务隔离级别<ul>
<li>repeatable read</li>
<li>read uncommitted</li>
<li>read committed</li>
<li>sarializable</li>
</ul>
</li>
<li>查看隔离级别<ul>
<li>select @@transaction_isolation</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>事务分类<ul>
<li>本地事务</li>
<li>分布式事务<ul>
<li>操作不同数据库，来保证一致性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>索引<ul>
<li>作用<ul>
<li>相当于书的目录，快速查找</li>
</ul>
</li>
<li>可以建立多个索引</li>
<li>常用索引类型<ul>
<li>primary key</li>
<li>unique</li>
<li>not null</li>
</ul>
</li>
<li>联合索引<ul>
<li>优点<ul>
<li>就像查字典一样，通过减少搜索的范围，增大索引效率，更快速的查找数据</li>
<li>复合索引比两个单独索引效果好</li>
</ul>
</li>
<li>特点<ul>
<li>最左匹配<ul>
<li>字段 1</li>
<li>字段 1 字段 2</li>
<li>字段 1 字段 2 字段 3</li>
<li>左边不能少，右边可以少</li>
<li>像字典一样</li>
</ul>
</li>
<li>不起作用的匹配<ul>
<li>字段 2</li>
<li>字段 3</li>
<li>字段 2 字段 3</li>
</ul>
</li>
</ul>
</li>
<li>将多个字段设置为索引</li>
<li>定义<ul>
<li>添加<ul>
<li>alter table 表名 add index 索引名 (字段 1，字段 2)<ul>
<li>字段需要非空</li>
<li>字段顺序非常重要</li>
</ul>
</li>
</ul>
</li>
<li>删除<ul>
<li>alter table 表名 drop index 索引名</li>
</ul>
</li>
<li>查<ul>
<li>show index from 表名</li>
</ul>
</li>
</ul>
</li>
<li>使用场景<ul>
<li>排序</li>
<li>分组</li>
<li>外键</li>
</ul>
</li>
<li>不应当使用的场景<ul>
<li>表需要频繁增删改</li>
<li>第一个字段数据量很大</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>进阶</p>
<ul>
<li>设计表<ul>
<li>存储引擎（做表类型）<ul>
<li>查看数据库的引擎<ul>
<li>show engines</li>
</ul>
</li>
<li>分类<ul>
<li>InnoDB<ul>
<li>事务型</li>
<li>并发</li>
<li>外键</li>
<li>崩溃后可以恢复</li>
</ul>
</li>
<li>MyISAM</li>
</ul>
</li>
</ul>
</li>
<li>可以通过界面来分析字段</li>
<li>命名<ul>
<li>小写字母下划线<ul>
<li>主键索引名<ul>
<li>pk_字段名</li>
</ul>
</li>
<li>唯一索引名<ul>
<li>uk_字段名</li>
</ul>
</li>
<li>普通索引名<ul>
<li>idx_字段名</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>一个表代表一个类<ul>
<li>表要小而精， 和类一样<ul>
<li>将字段很多的表分为多个表</li>
</ul>
</li>
<li>字段<ul>
<li>必须的<ul>
<li>id<ul>
<li>自增</li>
</ul>
</li>
<li>create_time<ul>
<li>非空</li>
</ul>
</li>
<li>update_time<ul>
<li>非空</li>
</ul>
</li>
<li>is_deleted<ul>
<li>软删除<ul>
<li>保证数据完整性<ul>
<li>藏数据。。</li>
</ul>
</li>
<li>查</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>设置搜索频率高的字段为索引<ul>
<li>原理<ul>
<li>索引会按照特定的数据结构（如 B 树、B+树）对字段值进行排序和存储，使得数据库引擎可以更快速地定位到需要查询的数据，而不需要逐行扫描整个表</li>
</ul>
</li>
</ul>
</li>
<li>少用外键， 逻辑可以写在代码里<ul>
<li>减小数据库计算压力</li>
<li>外键多了，数据库无法扩容</li>
<li>不能做分库分表<ul>
<li>不同数据库不能用外键</li>
</ul>
</li>
</ul>
</li>
<li>表的字段很多时<ul>
<li>分表<ul>
<li>条件查询</li>
<li>相信内容</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>多实例<ul>
<li>一个 pc 装多个 mysql，port 不同</li>
</ul>
</li>
<li>
<p>高端操作</p>
<ul>
<li>
<p>主从同步</p>
<ul>
<li>
<p>原理</p>
<ul>
<li>从机查看主机二进制日志<ul>
<li>binary log<ul>
<li>二进制日志</li>
</ul>
</li>
</ul>
</li>
<li>详细描述</li>
</ul>
</li>
<li>
<p>新问题</p>
<ul>
<li>ms 级别的同步延迟</li>
</ul>
</li>
<li>
<p>作用</p>
<ul>
<li>读写分离，缓解数据库压力<ul>
<li>应用场景<ul>
<li>读请求很多，写请求较少</li>
</ul>
</li>
<li>操作<ul>
<li>主机配置</li>
<li>同步内容</li>
<li>主机授权<ul>
<li>grant replication slave on <em>.</em> to 'repl'@'%';</li>
</ul>
</li>
<li>从机连接</li>
</ul>
</li>
</ul>
</li>
<li>高可用<ul>
<li>一个挂了另一个跟上</li>
<li>注意点</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>集群</p>
<ul>
<li>数据库集群方式？？</li>
</ul>
</li>
</ul>
</li>
<li>
<p>调优</p>
<ul>
<li>show profiles<ul>
<li>大局时间</li>
</ul>
</li>
<li>show profile<ul>
<li>细节时间</li>
</ul>
</li>
<li>performance_schema</li>
<li>分库分表</li>
</ul>
</li>
<li>数据库连接池<ul>
<li>概念<ul>
<li>分配、管理和释放 数据库的连接</li>
<li>数据库的连接<ul>
<li>tcpip 连接</li>
<li>数据库登录</li>
<li>sql 执行</li>
<li>数据库退出</li>
<li>tcpip 断开连接</li>
</ul>
</li>
</ul>
</li>
<li>好处<ul>
<li>减少网络开销，减少数据库登录，退出</li>
</ul>
</li>
<li>步骤<ul>
<li>创建<ul>
<li>栈</li>
</ul>
</li>
<li>管理<ul>
<li>客户端请求连接<ul>
<li>空闲的数据库的连接<ul>
<li>有<ul>
<li>分配</li>
</ul>
</li>
<li>没有<ul>
<li>是否达到最大连接数<ul>
<li>否<ul>
<li>创建新的连接</li>
</ul>
</li>
<li>是<ul>
<li>等待时间<ul>
<li>超时报警</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>客户端释放连接<ul>
<li>删除</li>
<li>保留</li>
</ul>
</li>
</ul>
</li>
<li>关闭</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>原理</p>
<ul>
<li>b+树<ul>
<li>又矮又胖，查询效率高</li>
<li>二叉树效率低</li>
</ul>
</li>
</ul>
</li>
<li>用 python 操作<ul>
<li>import pymysql<ul>
<li>步骤<ul>
<li>q = connect(host, port, user, password, db, charset)</li>
<li>p = q.cursor()</li>
<li>sql 语句<ul>
<li>查<ul>
<li>p.execute(sql, params) 或者 p.executemany(sql, params)<ul>
<li>必须两个参数，防止 sql 注入语句</li>
<li>sql：语句，参数用%s</li>
<li>params： 元组参数</li>
</ul>
</li>
<li>p.fetchall()</li>
</ul>
</li>
<li>增删改<ul>
<li>try<ul>
<li>p.execute(sql, params) 或者 p.executemany(sql, params)<ul>
<li>必须两个参数，防止 sql 注入语句</li>
<li>sql：语句，参数用%s</li>
<li>params： 元组参数</li>
</ul>
</li>
<li>q.commit()</li>
<li>except<ul>
<li>q.rollback()</li>
</ul>
</li>
<li>else</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>p.close()</li>
<li>q.close()</li>
</ul>
</li>
</ul>
</li>
<li>sqlalchemy<ul>
<li>使用类和对象转为 sql</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>PostgreSQL</p>
<ul>
<li>支持海量数据</li>
</ul>
</li>
<li>支持 sql 语句，<ul>
<li>3306</li>
</ul>
</li>
<li>适用于复杂查询<ul>
<li>子查询</li>
<li>聚合函数<ul>
<li>count</li>
<li>sum</li>
<li>avg</li>
<li>max</li>
<li>min</li>
</ul>
</li>
<li>分组</li>
<li>排序</li>
<li>过滤</li>
</ul>
</li>
</ul>
</li>
<li>
<p>非关系型</p>
<ul>
<li>
<p>不支持 sql 语句，适用于关系简单的数据</p>
<ul>
<li>
<p>k-v</p>
<ul>
<li>
<p>redis</p>
<ul>
<li>概念<ul>
<li>关系简单的存储</li>
<li>需要配置环境变量 path</li>
<li>cs 架构<ul>
<li>启动命令<ul>
<li>redis-server</li>
</ul>
</li>
<li>使用命令<ul>
<li>redis-cli</li>
</ul>
</li>
</ul>
</li>
<li>特点<ul>
<li>16 个数据库</li>
<li>速度快<ul>
<li>操作内存<ul>
<li>效率很高</li>
</ul>
</li>
<li>单线程<ul>
<li>避免切换上下文</li>
</ul>
</li>
</ul>
</li>
<li>6379</li>
</ul>
</li>
</ul>
</li>
<li>存储数据类型
    _ hash
    _ 遍历快
    _ set
    _ sorted set
    _ list
    _ string</li>
<li>操作命令<ul>
<li>select 1</li>
<li>查看<ul>
<li>keys *<ul>
<li>少用，会卡</li>
<li>查看所有的键</li>
</ul>
</li>
<li>get key</li>
<li>type k1<ul>
<li>看类型</li>
</ul>
</li>
</ul>
</li>
<li>增<ul>
<li>set key value</li>
<li>mset k1 v1 k2 v2 ...<ul>
<li>批量</li>
</ul>
</li>
</ul>
</li>
<li>改<ul>
<li>rename k1 new_k1</li>
</ul>
</li>
<li>删<ul>
<li>del k1 k2</li>
<li>flushdb<ul>
<li>删除一个库</li>
</ul>
</li>
<li>flushall<ul>
<li>删除所有库</li>
</ul>
</li>
</ul>
</li>
<li>设置密码<ul>
<li>config rewrite</li>
</ul>
</li>
<li>exit</li>
</ul>
</li>
<li>缓存<ul>
<li>逻辑结构<ul>
<li>数据库<ul>
<li>一级缓存<ul>
<li>sqlalchemy 的 session</li>
</ul>
</li>
<li>二级缓存<ul>
<li>redis</li>
</ul>
</li>
<li>三级缓存<ul>
<li>nginx</li>
<li>最快，但可能是脏数据</li>
</ul>
</li>
</ul>
</li>
<li>客户端</li>
</ul>
</li>
</ul>
</li>
<li>实际使用<ul>
<li>缓存<ul>
<li>数据同步方式<ul>
<li>更新数据库，删除缓存<ul>
<li>没有缓存，查询数据库</li>
<li>有缓存，返回缓存数据</li>
<li>更改收据库后，设置缓存失效</li>
</ul>
</li>
<li>canal 读取 mysql 的 binlog</li>
</ul>
</li>
<li>设置合理的有效时间</li>
</ul>
</li>
<li>消息队列<ul>
<li>发布订阅</li>
<li>事务</li>
</ul>
</li>
</ul>
</li>
<li>远程连接<ul>
<li>修改 redis.conf<ul>
<li>注释掉里面的 bind</li>
<li>protected-mode<ul>
<li>改为 no</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>主从同步</p>
<ul>
<li>启动 * redis 配置文件</li>
<li>
<p>断开</p>
</li>
<li>
<p>redis-cli info replication</p>
</li>
<li>原理<ul>
<li>全量同步</li>
<li>部分同步</li>
<li>命令传播</li>
</ul>
</li>
<li>redis-cli role</li>
<li>master 必须做持久化<ul>
<li>防止丢失</li>
</ul>
</li>
</ul>
</li>
<li>
<p>集群</p>
<ul>
<li>多台服务器 交叉主从同步<ul>
<li>防止一台服务器挂掉。数据异常</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>文档数据库</p>
<ul>
<li>mongoDB</li>
</ul>
</li>
</ul>
</li>
<li>
<p>shelve</p>
<ul>
<li>概念<ul>
<li>Python 中的数据库，以二进制存储字典</li>
</ul>
</li>
<li>方法<ul>
<li>with shelve.open() as db:<ul>
<li>open()</li>
<li>close()</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../css-guide/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Css guide">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Css guide
              </div>
            </div>
          </a>
        
        
          
          <a href="../../f2/AI%E6%95%99%E7%A8%8B/" class="md-footer__link md-footer__link--next" aria-label="Next: AI教程">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                AI教程
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 zhenda
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.prefetch", "navigation.expand", "navigation.path", "navigation.top", "navigation.tracking", "navigation.footer", "search.suggest", "search.highlight", "content.code.copy", "content.action.edit", "content.action.view", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>